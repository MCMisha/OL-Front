import{a as M}from"./chunk-SNP62HCC.js";import{a as Me,c as Ee}from"./chunk-H5ZME2Y7.js";import{a as y}from"./chunk-SKCIPK7T.js";import{a as $,b as he,c as we,d as ve,e as Ce,f as be,g as xe,h as Se,i as q,j as W,l as ye}from"./chunk-Y5YQ2IGH.js";import{b as S}from"./chunk-XBWCA7LY.js";import{a as Pe}from"./chunk-66SS6LDS.js";import{a as G}from"./chunk-XJZG4PQT.js";import{Aa as z,Ba as V,Ea as L,Fa as B,Ga as H,Ha as O,Ia as _e,Ja as ge,S as P,qa as R,ra as T,va as x,xa as k,ya as h}from"./chunk-HWDLRLPX.js";import"./chunk-6XXA7HXI.js";import{i as D,k as j,l as fe,m as X}from"./chunk-ZZO7MJK5.js";import{$b as pe,Ab as U,Bb as J,Db as E,Gb as f,Ib as g,Jc as de,Lb as oe,Lc as F,Nb as le,Ob as me,Oc as ue,Pb as ce,Rb as m,Sb as K,V as ae,W as Z,Wa as l,Xa as p,_b as se,ba as N,e as w,ga as re,j as ne,la as v,ma as A,mb as u,ob as o,t as I,ta as C,ua as b,xb as a,yb as r,zb as _}from"./chunk-YKDFZCCH.js";var ke=()=>[2,5,10],ze=e=>({highlighted:e});function Ve(e,s){e&1&&(a(0,"th",13),m(1,"Id"),r())}function Le(e,s){if(e&1&&(a(0,"td",14),m(1),r()),e&2){let t=s.$implicit;l(),K(t.id)}}function Be(e,s){e&1&&(a(0,"th",13),m(1,"Nazwa"),r())}function He(e,s){if(e&1&&(a(0,"td",14),m(1),r()),e&2){let t=s.$implicit;l(),K(t.name)}}function Oe(e,s){e&1&&_(0,"tr",15)}function Ge(e,s){if(e&1){let t=E();a(0,"tr",16),f("click",function(){let i=C(t).$implicit,c=g();return b(c.highlightRow(i))}),r()}if(e&2){let t=s.$implicit,n=g();o("ngClass",pe(1,ze,n.selectedRowIndex==t.id))}}var De=(()=>{class e{constructor(t,n){this.dialog=t,this.adminPlaceService=n,this.places=[],this.pageSize=5,this.pageIndex=0,this.displayedColumns=["id","name"],this.dataSourceWithPageSize=new ye(this.places),this.subscription=new w,this.destroy$=new ne,this._snackBar=re(Pe)}ngOnInit(){this.subscription.add(this.adminPlaceService.getPlaces().pipe(Z(this.destroy$)).subscribe(t=>{this.places=t,this.dataSourceWithPageSize.data=this.places}))}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}openDialog(){this.dialog.open(Ee,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(n=>{n&&this.deletePlace()})}ngOnDestroy(){this.subscription.unsubscribe()}deletePlace(){this.selectedRow&&this.subscription.add(this.adminPlaceService.deletePlace(this.selectedRow.id).pipe(Z(this.destroy$)).subscribe(()=>{this.ngOnInit()},t=>{this._snackBar.open(`Bl\u0105d podczas usuni\u0119cia: ${t.error}`,"Zamknij",{duration:5e3})}))}static{this.\u0275fac=function(n){return new(n||e)(p(Me),p(M))}}static{this.\u0275cmp=v({type:e,selectors:[["app-admin-panel-place"]],viewQuery:function(n,i){if(n&1&&le(S,5),n&2){let c;me(c=ce())&&(i.paginator=c.first)}},decls:20,vars:11,consts:[[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(n,i){n&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),m(3,"Dodaj"),r()(),a(4,"div",1)(5,"button",3),m(6,"Edytuj"),r()(),a(7,"div",1)(8,"button",4),f("click",function(){return i.openDialog()}),m(9,"Usu\u0144"),r()()(),a(10,"table",5),U(11,6),u(12,Ve,2,0,"th",7)(13,Le,2,1,"td",8),J(),U(14,9),u(15,Be,2,0,"th",7)(16,He,2,1,"td",8),J(),u(17,Oe,1,0,"tr",10)(18,Ge,1,3,"tr",11),r(),_(19,"mat-paginator",12)),n&2&&(l(5),oe("routerLink","",i.selectedRow==null?null:i.selectedRow.id,"/edit"),o("disabled",!i.selectedRow),l(3),o("disabled",!i.selectedRow),l(2),o("dataSource",i.dataSourceWithPageSize),l(7),o("matHeaderRowDef",i.displayedColumns),l(),o("matRowDefColumns",i.displayedColumns),l(),o("pageSize",i.pageSize)("pageIndex",i.pageIndex)("pageSizeOptions",se(10,ke)))},dependencies:[de,fe,P,be,he,ve,Ce,q,xe,S,W,Se,$,we],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}"]})}}return e})();function Ze(e,s){e&1&&_(0,"mat-progress-bar",9)}function Ue(e,s){e&1&&(a(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),r())}function Je(e,s){e&1&&(a(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),r())}function Ke(e,s){e&1&&(a(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),r())}function Xe(e,s){e&1&&(a(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),r())}var je=(()=>{class e{constructor(t,n,i,c){this.placeService=t,this.fb=n,this.router=i,this.route=c,this.existingPlaces=[],this.subscription=new w}ngOnInit(){this.subscription.add(this.placeService.getPlaces().subscribe(t=>{this.existingPlaces=t})),this.newPlaceForm=this.fb.group({placeName:["",[h.required,h.minLength(3),h.maxLength(50)],[this.placeExistsValidator.bind(this)]]})}ngOnDestroy(){this.subscription.unsubscribe()}placeExistsValidator(t){return this.placeService.getPlaces().pipe(I(n=>n.some(c=>c.name.toLowerCase()===t.value.toLowerCase())?{placeExists:!0}:null))}savePlace(){if(this.newPlaceForm.valid){let t=this.newPlaceForm.value.placeName;this.placeService.createPlace({id:0,name:t}).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(M),p(O),p(j),p(D))}}static{this.\u0275cmp=v({type:e,selectors:[["app-admin-panel-place-new"]],decls:17,vars:7,consts:[["mode","indeterminate",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate"]],template:function(n,i){if(n&1&&(u(0,Ze,1,0,"mat-progress-bar",0),a(1,"form",1),f("ngSubmit",function(){return i.savePlace()}),a(2,"mat-form-field",2)(3,"mat-label"),m(4,"Nazwa miejsca"),r(),_(5,"input",3),u(6,Ue,2,0,"mat-error",4)(7,Je,2,0,"mat-error",4)(8,Ke,2,0,"mat-error",4)(9,Xe,2,0,"mat-error",4),r()(),a(10,"div",5)(11,"div",6)(12,"button",7),f("click",function(){return i.savePlace()}),m(13," Zapisz "),r()(),a(14,"div",6)(15,"button",8),f("click",function(){return i.router.navigate([".."],{relativeTo:i.route})}),m(16," Anuluj "),r()()()),n&2){let c,d,Y,ee,te,ie;o("ngIf",(c=i.newPlaceForm.get("placeName"))==null?null:c.pending),l(),o("formGroup",i.newPlaceForm),l(5),o("ngIf",(d=i.newPlaceForm.get("placeName"))==null?null:d.hasError("required")),l(),o("ngIf",(Y=i.newPlaceForm.get("placeName"))==null?null:Y.hasError("minlength")),l(),o("ngIf",(ee=i.newPlaceForm.get("placeName"))==null?null:ee.hasError("maxlength")),l(),o("ngIf",(te=i.newPlaceForm.get("placeName"))==null?null:te.hasError("placeExists")),l(3),o("disabled",i.newPlaceForm.invalid||((ie=i.newPlaceForm.get("placeName"))==null?null:ie.pending))}},dependencies:[F,P,L,k,z,V,T,x,G,R,y,B,H]})}}return e})();function Ye(e,s){e&1&&_(0,"mat-progress-bar",7)}function et(e,s){e&1&&(a(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),r())}function tt(e,s){e&1&&(a(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),r())}function it(e,s){e&1&&(a(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),r())}function nt(e,s){e&1&&(a(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),r())}function at(e,s){if(e&1){let t=E();a(0,"form",8),f("ngSubmit",function(){C(t);let i=g(2);return b(i.savePlace())}),a(1,"mat-form-field",9)(2,"mat-label"),m(3,"Nazwa miejsca"),r(),_(4,"input",10),u(5,et,2,0,"mat-error",0)(6,tt,2,0,"mat-error",0)(7,it,2,0,"mat-error",0)(8,nt,2,0,"mat-error",0),r()()}if(e&2){let t,n,i,c,d=g(2);o("formGroup",d.editPlaceForm),l(5),o("ngIf",d.editPlaceForm==null||(t=d.editPlaceForm.get("placeName"))==null?null:t.hasError("required")),l(),o("ngIf",d.editPlaceForm==null||(n=d.editPlaceForm.get("placeName"))==null?null:n.hasError("minlength")),l(),o("ngIf",d.editPlaceForm==null||(i=d.editPlaceForm.get("placeName"))==null?null:i.hasError("maxlength")),l(),o("ngIf",d.editPlaceForm==null||(c=d.editPlaceForm.get("placeName"))==null?null:c.hasError("placeExists"))}}function rt(e,s){if(e&1){let t=E();a(0,"div"),u(1,Ye,1,0,"mat-progress-bar",1)(2,at,9,5,"form",2),a(3,"div",3)(4,"div",4)(5,"button",5),f("click",function(){C(t);let i=g();return b(i.savePlace())}),m(6," Zapisz "),r()(),a(7,"div",4)(8,"button",6),f("click",function(){C(t);let i=g();return b(i.router.navigate(["../.."],{relativeTo:i.route}))}),m(9," Anuluj "),r()()()()}if(e&2){let t,n,i=g();l(),o("ngIf",(t=i.editPlaceForm.get("placeName"))==null?null:t.pending),l(),o("ngIf",i.editPlaceForm),l(3),o("disabled",i.editPlaceForm.invalid||((n=i.editPlaceForm.get("placeName"))==null?null:n.pending))}}var Re=(()=>{class e{constructor(t,n,i,c){this.placeService=t,this.fb=n,this.router=i,this.route=c,this.existingPlaces=[],this.subscription=new w,this.placePerformances=[],this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.subscription.add(this.route.params.pipe(ae(t=>(this.currentPlaceId=+t.id,this.placeService.getPlaces()))).subscribe(t=>{this.existingPlaces=t;let n=t.find(i=>i.id===this.currentPlaceId);n&&(this.editPlaceForm=this.fb.group({placeName:[n.name,[h.required,h.minLength(3),h.maxLength(50)],[this.genreExistsValidator.bind(this)]]})),this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}genreExistsValidator(t){return this.placeService.getPlaces().pipe(I(n=>n.some(c=>c.name.toLowerCase()===t.value.toLowerCase()&&c.id!==this.currentPlaceId)?{placeExists:!0}:null))}savePlace(){if(this.editPlaceForm.valid){let t=this.editPlaceForm.value.placeName;this.placeService.updatePlace({id:this.currentPlaceId,name:t}).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(M),p(O),p(j),p(D))}}static{this.\u0275cmp=v({type:e,selectors:[["app-admin-panel-place-edit"]],decls:1,vars:1,consts:[[4,"ngIf"],["mode","indeterminate",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"]],template:function(n,i){n&1&&u(0,rt,10,3,"div",0),n&2&&o("ngIf",i.editPlaceForm)},dependencies:[F,P,L,k,z,V,T,x,G,R,y,B,H]})}}return e})();var ot=[{path:"",component:De},{path:"new",component:je},{path:":id/edit",component:Re}],Te=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=A({type:e})}static{this.\u0275inj=N({imports:[X.forChild(ot),X]})}}return e})();var ti=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=A({type:e})}static{this.\u0275inj=N({imports:[ue,Te,P,q,S,W,$,_e,x,y,ge]})}}return e})();export{ti as AdminPanelPlaceModule};
