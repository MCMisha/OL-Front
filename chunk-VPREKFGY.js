import{a as xe,b as Ae}from"./chunk-5NYCPYWY.js";import{a as k}from"./chunk-WZF2H5BH.js";import{c as Me}from"./chunk-QIZ7K7AG.js";import{a as j,b as he,c as Ne,d as be,e as Ce,f as ve,g as Ie,h as Se,i as V,j as L,l as ye}from"./chunk-5NUJBZGR.js";import{a as _e}from"./chunk-L5GEZE5Y.js";import{a as I}from"./chunk-SIWY5EPZ.js";import{b as R}from"./chunk-E52NFQY5.js";import{a as $}from"./chunk-BKP4CZB2.js";import{Ba as se,Ca as de,Fa as ue,Ga as pe,Ha as ce,La as fe,Ma as we,Na as ge,S as v,T as E,qa as ae,ra as oe,sa as me,va as T,ya as le,za as p}from"./chunk-Q53X4CUR.js";import"./chunk-6XXA7HXI.js";import{a as te,i as ie,k as ne,l as re,m as q}from"./chunk-G5IVLWJY.js";import{$b as Q,Ab as g,Bb as S,Cb as y,Eb as b,Hb as c,Jb as C,Jc as Y,Lc as D,Nb as K,Oc as ee,Sb as H,Tb as o,Ub as M,Xa as l,Ya as _,aa as Z,ac as X,ba as A,e as x,fa as J,la as F,ma as P,nb as u,pb as s,ta as f,ua as w,yb as r,zb as n}from"./chunk-DQM3UAK6.js";var B=(()=>{class e{constructor(t){this.http=t}getNews(){return this.http.get(`${$.baseApiUri}/AdminNews/all`,{withCredentials:!0})}createNews(t){return this.http.post(`${$.baseApiUri}/AdminNews/create`,t,{withCredentials:!0})}static{this.\u0275fac=function(a){return new(a||e)(J(te))}}static{this.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ve=()=>[2,5,10],Le=e=>({highlighted:e});function ze(e,m){e&1&&g(0,"mat-progress-bar",16)}function Be(e,m){e&1&&(r(0,"th",17),o(1,"Id"),n())}function He(e,m){if(e&1&&(r(0,"td",18),o(1),n()),e&2){let t=m.$implicit;l(),M(t.id)}}function qe(e,m){e&1&&(r(0,"th",17),o(1,"Nazwa"),n())}function $e(e,m){if(e&1&&(r(0,"td",18),o(1),n()),e&2){let t=m.$implicit;l(),M(t.title)}}function Oe(e,m){e&1&&(r(0,"th",17),o(1,"Podtytu\u0142"),n())}function Ge(e,m){if(e&1&&(r(0,"td",18),o(1),n()),e&2){let t=m.$implicit;l(),M(t.subtitle)}}function We(e,m){e&1&&(r(0,"th",17),o(1,"Data utworzenia"),n())}function Ue(e,m){if(e&1&&(r(0,"td",18),o(1),n()),e&2){let t=m.$implicit;l(),M(t.creationDate)}}function Ze(e,m){e&1&&g(0,"tr",19)}function Je(e,m){if(e&1){let t=b();r(0,"tr",20),c("click",function(){let i=f(t).$implicit,d=C();return w(d.highlightRow(i))}),n()}if(e&2){let t=m.$implicit,a=C();s("ngClass",X(1,Le,a.selectedRowIndex==t.id))}}var Pe=(()=>{class e{constructor(t,a){this.newsService=t,this.dialog=a,this.isLoading=!0,this.displayedColumns=["id","title","subtitle","creationDate"],this.news=[],this.subscription=new x,this.dataSourceWithPageSize=new ye(this.news),this.pageSize=5,this.pageIndex=0}ngOnInit(){this.subscription.add(this.newsService.getNews().subscribe(t=>{this.news=t,this.dataSourceWithPageSize.data=this.news,this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}openDialog(){}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}static{this.\u0275fac=function(a){return new(a||e)(_(B),_(Me))}}static{this.\u0275cmp=F({type:e,selectors:[["app-admin-panel-news"]],decls:27,vars:12,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","subtitle"],["matColumnDef","creationDate"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mode","indeterminate",1,"mb-1"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(a,i){a&1&&(u(0,ze,1,0,"mat-progress-bar",0),r(1,"div",1)(2,"div",2)(3,"button",3),o(4,"Dodaj"),n()(),r(5,"div",2)(6,"button",4),o(7,"Edytuj"),n()(),r(8,"div",2)(9,"button",5),c("click",function(){return i.openDialog()}),o(10,"Usu\u0144"),n()()(),r(11,"table",6),S(12,7),u(13,Be,2,0,"th",8)(14,He,2,1,"td",9),y(),S(15,10),u(16,qe,2,0,"th",8)(17,$e,2,1,"td",9),y(),S(18,11),u(19,Oe,2,0,"th",8)(20,Ge,2,1,"td",9),y(),S(21,12),u(22,We,2,0,"th",8)(23,Ue,2,1,"td",9),y(),u(24,Ze,1,0,"tr",13)(25,Je,1,3,"tr",14),n(),g(26,"mat-paginator",15)),a&2&&(s("ngIf",i.isLoading),l(6),K("routerLink","",i.selectedRow==null?null:i.selectedRow.id,"/edit"),s("disabled",!i.selectedRow),l(3),s("disabled",!i.selectedRow),l(2),s("dataSource",i.dataSourceWithPageSize),l(13),s("matHeaderRowDef",i.displayedColumns),l(),s("matRowDefColumns",i.displayedColumns),l(),s("pageSize",i.pageSize)("pageIndex",i.pageIndex)("pageSizeOptions",Q(11,Ve)))},dependencies:[Y,D,re,v,I,ve,he,be,Ce,V,Ie,R,L,Se,j,Ne],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}"]})}}return e})();function Ke(e,m){e&1&&g(0,"mat-progress-bar",15)}function Qe(e,m){e&1&&(r(0,"mat-error"),o(1," Tytu\u0142 jest wymagany "),n())}function Xe(e,m){e&1&&(r(0,"mat-error"),o(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function Ye(e,m){e&1&&(r(0,"mat-error"),o(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 101 "),n())}function et(e,m){e&1&&(r(0,"mat-error"),o(1," Podtytu\u0142 jest wymagany "),n())}function tt(e,m){e&1&&(r(0,"mat-error"),o(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function it(e,m){e&1&&(r(0,"mat-error"),o(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 101 "),n())}function nt(e,m){if(e&1){let t=b();r(0,"button",16),c("click",function(){f(t),C();let i=H(23);return w(i.click())}),r(1,"mat-icon",17),o(2,"image"),n()()}}function rt(e,m){if(e&1){let t=b();r(0,"button",16),c("click",function(){f(t);let i=C();return w(i.onDeleteImage())}),r(1,"mat-icon",17),o(2,"delete"),n()()}}function at(e,m){e&1&&(r(0,"mat-error"),o(1," G\u0142\xF3wny obraz jest wymagany "),n())}var De=(()=>{class e{constructor(t,a,i,d){this.newsService=t,this.fb=a,this.router=i,this.route=d,this.isLoading=!0,this.subscription=new x,this.news=[],this.mainImage="data:image/jpeg;base64,",this.isFileLoaded=!1}ngOnInit(){this.subscription.add(this.newsService.getNews().subscribe(t=>{this.news=t,this.isLoading=!1})),this.newNewsForm=this.fb.group({title:["",[p.required,p.minLength(2),p.maxLength(100)]],subTitle:["",[p.required,p.minLength(2),p.maxLength(100)]],mainImage:[null,[p.required]],creationDate:[new Date,[p.required]],content:["",[p.required,p.minLength(2),p.maxLength(5e3)]]})}ngOnDestroy(){this.subscription.unsubscribe()}onFileSelected(t){let a=t.target;if(!a.files||a.files.length===0)return;let i=a.files[0];this.selectedFileName=i.name,this.isFileLoaded=!1;let d=new FileReader;d.readAsDataURL(i),d.onload=()=>{this.selectedFile=d.result.split(",")[1],this.mainImage=d.result,this.isFileLoaded=!0,this.newNewsForm.patchValue({mainImage:i.name}),this.newNewsForm.get("mainImage")?.updateValueAndValidity()},a.value=""}onDeleteImage(){this.selectedFile=void 0,this.selectedFileName=void 0,this.isFileLoaded=!1,this.newNewsForm.patchValue({mainImage:null}),this.newNewsForm.get("mainImage")?.updateValueAndValidity(),this.mainImage="data:image/jpeg;base64,"}saveNews(){if(this.newNewsForm.invalid){console.error("Formularz jest nieprawid\u0142owy lub plik nadal si\u0119 \u0142aduje!");return}let t={title:this.newNewsForm.value.title,subTitle:this.newNewsForm.value.subTitle,mainImage:this.selectedFile,creationDate:this.newNewsForm.value.creationDate,content:this.newNewsForm.value.content};this.newsService.createNews(t).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}static{this.\u0275fac=function(a){return new(a||e)(_(B),_(fe),_(ne),_(ie))}}static{this.\u0275cmp=F({type:e,selectors:[["app-admin-panel-news-new"]],decls:37,vars:13,consts:[["mainImageInput",""],["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup"],[1,"ms-1","mb-1","d-flex","align-items-center"],["appearance","fill",2,"width","500px"],["matInput","","formControlName","title","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],["matInput","","formControlName","subTitle","placeholder","Wprowad\u017A nazw\u0119 miejsca"],["type","file","accept","image/*","hidden","",3,"change"],["matInput","","required","","readonly","",3,"click","value"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["formControlName","content"],[1,"me-4"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"],["mat-icon-button","","matSuffix","",3,"click"],["matSuffix",""]],template:function(a,i){if(a&1){let d=b();u(0,Ke,1,0,"mat-progress-bar",1),r(1,"form",2)(2,"div",3)(3,"mat-form-field",4)(4,"mat-label"),o(5,"Tytu\u0142 aktualno\u015Bci"),n(),g(6,"input",5),u(7,Qe,2,0,"mat-error",6)(8,Xe,2,0,"mat-error",6)(9,Ye,2,0,"mat-error",6),n()(),r(10,"div",3)(11,"mat-form-field",4)(12,"mat-label"),o(13,"Podtytu\u0142 aktualno\u015Bci"),n(),g(14,"input",7),u(15,et,2,0,"mat-error",6)(16,tt,2,0,"mat-error",6)(17,it,2,0,"mat-error",6),n()(),r(18,"div",3)(19,"mat-form-field",4)(20,"mat-label"),o(21,"G\u0142\xF3wny obraz"),n(),r(22,"input",8,0),c("change",function(N){return f(d),w(i.onFileSelected(N))}),n(),r(24,"input",9),c("click",function(){f(d);let N=H(23);return w(N.click())}),n(),u(25,nt,3,0,"button",10)(26,rt,3,0,"button",10)(27,at,2,0,"mat-error",6),n()(),r(28,"div",3),g(29,"app-rich-text-editor",11),n()(),r(30,"div",3)(31,"div",12)(32,"button",13),c("click",function(){return f(d),w(i.saveNews())}),o(33," Zapisz "),n()(),r(34,"div")(35,"button",14),c("click",function(){return f(d),w(i.router.navigate([".."],{relativeTo:i.route}))}),o(36," Anuluj "),n()()()}if(a&2){let d,h,N,O,G,W,U;s("ngIf",i.isLoading),l(),s("formGroup",i.newNewsForm),l(6),s("ngIf",(d=i.newNewsForm.get("title"))==null?null:d.hasError("required")),l(),s("ngIf",(h=i.newNewsForm.get("title"))==null?null:h.hasError("minlength")),l(),s("ngIf",(N=i.newNewsForm.get("title"))==null?null:N.hasError("maxlength")),l(6),s("ngIf",(O=i.newNewsForm.get("subTitle"))==null?null:O.hasError("required")),l(),s("ngIf",(G=i.newNewsForm.get("subTitle"))==null?null:G.hasError("minlength")),l(),s("ngIf",(W=i.newNewsForm.get("subTitle"))==null?null:W.hasError("maxlength")),l(7),s("value",i.selectedFileName||"Nie wybrano pliku"),l(),s("ngIf",!i.selectedFileName),l(),s("ngIf",i.selectedFileName),l(),s("ngIf",(U=i.newNewsForm.get("mainImage"))==null?null:U.hasError("required")),l(5),s("disabled",i.newNewsForm.invalid)}},dependencies:[D,xe,ue,le,se,de,v,I,pe,ce,oe,T,_e,ae,k,E,me]})}}return e})();var ot=[{path:"",component:Pe},{path:"new",component:De}],Ee=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=P({type:e})}static{this.\u0275inj=A({imports:[q.forChild(ot),q]})}}return e})();var Qt=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=P({type:e})}static{this.\u0275inj=A({imports:[ee,Ee,Ae,we,v,I,V,R,L,j,ge,T,k,E]})}}return e})();export{Qt as AdminPanelNewsModule};
