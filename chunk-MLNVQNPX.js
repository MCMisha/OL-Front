import{a as M}from"./chunk-CUDEB3KK.js";import{a as Ee,c as xe}from"./chunk-ZZXSNTY4.js";import{a as h}from"./chunk-B2D6ZWPT.js";import{a as $,b as he,c as be,d as we,e as Ce,f as ve,g as Se,h as ye,i as q,j as W,l as Me}from"./chunk-DUUEYYWO.js";import{b as y}from"./chunk-5ZK5575K.js";import{a as Pe}from"./chunk-F635B2SA.js";import{a as G}from"./chunk-GIIDXOVM.js";import{Aa as z,Ba as L,Ea as B,Fa as V,Ga as H,Ha as O,Ia as ge,Ja as _e,S as _,qa as R,ra as T,va as S,xa as k,ya as P}from"./chunk-UILTVVM7.js";import"./chunk-6XXA7HXI.js";import{i as D,k as j,l as fe,m as X}from"./chunk-JD6FLVBJ.js";import{$b as ce,Ab as g,Bb as U,Cb as J,Eb as F,Hb as f,Jb as C,Kc as de,Mb as oe,Mc as v,Ob as le,Pb as me,Pc as ue,Qb as se,Sb as m,Tb as K,V as ae,W as Z,Xa as s,Ya as p,ac as pe,ba as x,e as b,ga as re,j as ne,la as w,ma as I,nb as u,pb as l,t as E,ta as N,ua as A,yb as r,zb as o}from"./chunk-C4UM4IA5.js";var ze=()=>[2,5,10],Le=e=>({highlighted:e});function Be(e,c){e&1&&g(0,"mat-progress-bar",14)}function Ve(e,c){e&1&&(r(0,"th",15),m(1,"Id"),o())}function He(e,c){if(e&1&&(r(0,"td",16),m(1),o()),e&2){let t=c.$implicit;s(),K(t.id)}}function Oe(e,c){e&1&&(r(0,"th",15),m(1,"Nazwa"),o())}function Ge(e,c){if(e&1&&(r(0,"td",16),m(1),o()),e&2){let t=c.$implicit;s(),K(t.name)}}function $e(e,c){e&1&&g(0,"tr",17)}function qe(e,c){if(e&1){let t=F();r(0,"tr",18),f("click",function(){let i=N(t).$implicit,a=C();return A(a.highlightRow(i))}),o()}if(e&2){let t=c.$implicit,n=C();l("ngClass",pe(1,Le,n.selectedRowIndex==t.id))}}var je=(()=>{class e{constructor(t,n){this.dialog=t,this.adminPlaceService=n,this.places=[],this.pageSize=5,this.pageIndex=0,this.displayedColumns=["id","name"],this.dataSourceWithPageSize=new Me(this.places),this.subscription=new b,this.destroy$=new ne,this._snackBar=re(Pe),this.isLoading=!0}ngOnInit(){this.subscription.add(this.adminPlaceService.getPlaces().pipe(Z(this.destroy$)).subscribe(t=>{this.places=t,this.dataSourceWithPageSize.data=this.places,this.isLoading=!1}))}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}openDialog(){this.dialog.open(xe,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(n=>{n&&this.deletePlace()})}ngOnDestroy(){this.subscription.unsubscribe()}deletePlace(){this.selectedRow&&this.subscription.add(this.adminPlaceService.deletePlace(this.selectedRow.id).pipe(Z(this.destroy$)).subscribe(()=>{this.ngOnInit()},t=>{this._snackBar.open(`Bl\u0105d podczas usuni\u0119cia: ${t.error}`,"Zamknij",{duration:5e3})}))}static{this.\u0275fac=function(n){return new(n||e)(p(Ee),p(M))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-place"]],viewQuery:function(n,i){if(n&1&&le(y,5),n&2){let a;me(a=se())&&(i.paginator=a.first)}},decls:21,vars:12,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mode","indeterminate",1,"mb-1"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(n,i){n&1&&(u(0,Be,1,0,"mat-progress-bar",0),r(1,"div",1)(2,"div",2)(3,"button",3),m(4,"Dodaj"),o()(),r(5,"div",2)(6,"button",4),m(7,"Edytuj"),o()(),r(8,"div",2)(9,"button",5),f("click",function(){return i.openDialog()}),m(10,"Usu\u0144"),o()()(),r(11,"table",6),U(12,7),u(13,Ve,2,0,"th",8)(14,He,2,1,"td",9),J(),U(15,10),u(16,Oe,2,0,"th",8)(17,Ge,2,1,"td",9),J(),u(18,$e,1,0,"tr",11)(19,qe,1,3,"tr",12),o(),g(20,"mat-paginator",13)),n&2&&(l("ngIf",i.isLoading),s(6),oe("routerLink","",i.selectedRow==null?null:i.selectedRow.id,"/edit"),l("disabled",!i.selectedRow),s(3),l("disabled",!i.selectedRow),s(2),l("dataSource",i.dataSourceWithPageSize),s(7),l("matHeaderRowDef",i.displayedColumns),s(),l("matRowDefColumns",i.displayedColumns),s(),l("pageSize",i.pageSize)("pageIndex",i.pageIndex)("pageSizeOptions",ce(11,ze)))},dependencies:[de,v,fe,_,ve,he,we,Ce,q,Se,y,W,ye,$,be,h],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}"]})}}return e})();function Ue(e,c){e&1&&g(0,"mat-progress-bar",9)}function Je(e,c){e&1&&(r(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),o())}function Ke(e,c){e&1&&(r(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function Xe(e,c){e&1&&(r(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function Ye(e,c){e&1&&(r(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),o())}var Re=(()=>{class e{constructor(t,n,i,a){this.placeService=t,this.fb=n,this.router=i,this.route=a,this.existingPlaces=[],this.subscription=new b}ngOnInit(){this.subscription.add(this.placeService.getPlaces().subscribe(t=>{this.existingPlaces=t})),this.newPlaceForm=this.fb.group({placeName:["",[P.required,P.minLength(3),P.maxLength(50)],[this.placeExistsValidator.bind(this)]]})}ngOnDestroy(){this.subscription.unsubscribe()}placeExistsValidator(t){return this.placeService.getPlaces().pipe(E(n=>n.some(a=>a.name.toLowerCase()===t.value.toLowerCase())?{placeExists:!0}:null))}savePlace(){if(this.newPlaceForm.valid){let t=this.newPlaceForm.value.placeName;this.placeService.createPlace({id:0,name:t}).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(M),p(O),p(j),p(D))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-place-new"]],decls:17,vars:7,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"]],template:function(n,i){if(n&1&&(u(0,Ue,1,0,"mat-progress-bar",0),r(1,"form",1),f("ngSubmit",function(){return i.savePlace()}),r(2,"mat-form-field",2)(3,"mat-label"),m(4,"Nazwa miejsca"),o(),g(5,"input",3),u(6,Je,2,0,"mat-error",4)(7,Ke,2,0,"mat-error",4)(8,Xe,2,0,"mat-error",4)(9,Ye,2,0,"mat-error",4),o()(),r(10,"div",5)(11,"div",6)(12,"button",7),f("click",function(){return i.savePlace()}),m(13," Zapisz "),o()(),r(14,"div",6)(15,"button",8),f("click",function(){return i.router.navigate([".."],{relativeTo:i.route})}),m(16," Anuluj "),o()()()),n&2){let a,d,Y,ee,te,ie;l("ngIf",(a=i.newPlaceForm.get("placeName"))==null?null:a.pending),s(),l("formGroup",i.newPlaceForm),s(5),l("ngIf",(d=i.newPlaceForm.get("placeName"))==null?null:d.hasError("required")),s(),l("ngIf",(Y=i.newPlaceForm.get("placeName"))==null?null:Y.hasError("minlength")),s(),l("ngIf",(ee=i.newPlaceForm.get("placeName"))==null?null:ee.hasError("maxlength")),s(),l("ngIf",(te=i.newPlaceForm.get("placeName"))==null?null:te.hasError("placeExists")),s(3),l("disabled",i.newPlaceForm.invalid||((ie=i.newPlaceForm.get("placeName"))==null?null:ie.pending))}},dependencies:[v,_,B,k,z,L,T,S,G,R,h,V,H]})}}return e})();function et(e,c){e&1&&g(0,"mat-progress-bar",6)}function tt(e,c){e&1&&(r(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),o())}function it(e,c){e&1&&(r(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function nt(e,c){e&1&&(r(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function at(e,c){e&1&&(r(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),o())}function rt(e,c){if(e&1){let t=F();r(0,"form",7),f("ngSubmit",function(){N(t);let i=C();return A(i.savePlace())}),r(1,"mat-form-field",8)(2,"mat-label"),m(3,"Nazwa miejsca"),o(),g(4,"input",9),u(5,tt,2,0,"mat-error",10)(6,it,2,0,"mat-error",10)(7,nt,2,0,"mat-error",10)(8,at,2,0,"mat-error",10),o()()}if(e&2){let t,n,i,a,d=C();l("formGroup",d.editPlaceForm),s(5),l("ngIf",d.editPlaceForm==null||(t=d.editPlaceForm.get("placeName"))==null?null:t.hasError("required")),s(),l("ngIf",d.editPlaceForm==null||(n=d.editPlaceForm.get("placeName"))==null?null:n.hasError("minlength")),s(),l("ngIf",d.editPlaceForm==null||(i=d.editPlaceForm.get("placeName"))==null?null:i.hasError("maxlength")),s(),l("ngIf",d.editPlaceForm==null||(a=d.editPlaceForm.get("placeName"))==null?null:a.hasError("placeExists"))}}var Te=(()=>{class e{constructor(t,n,i,a){this.placeService=t,this.fb=n,this.router=i,this.route=a,this.existingPlaces=[],this.subscription=new b,this.placePerformances=[],this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.editPlaceForm=this.fb.group({placeName:["",[P.required,P.minLength(3),P.maxLength(50)],[this.placeExistsValidator.bind(this)]]}),this.subscription.add(this.route.params.pipe(ae(t=>(this.currentPlaceId=+t.id,this.placeService.getPlaces()))).subscribe(t=>{this.existingPlaces=t;let n=t.find(i=>i.id===this.currentPlaceId);n&&this.editPlaceForm.patchValue({placeName:n.name}),this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}placeExistsValidator(t){return this.placeService.getPlaces().pipe(E(n=>n.some(a=>a.name.toLowerCase()===t.value.toLowerCase()&&a.id!==this.currentPlaceId)?{placeExists:!0}:null))}savePlace(){if(this.editPlaceForm.valid){let t=this.editPlaceForm.value.placeName;this.placeService.updatePlace({id:this.currentPlaceId,name:t}).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(M),p(O),p(j),p(D))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-place-edit"]],decls:9,vars:3,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"]],template:function(n,i){if(n&1&&(u(0,et,1,0,"mat-progress-bar",0)(1,rt,9,5,"form",1),r(2,"div",2)(3,"div",3)(4,"button",4),f("click",function(){return i.savePlace()}),m(5," Zapisz "),o()(),r(6,"div",3)(7,"button",5),f("click",function(){return i.router.navigate(["../.."],{relativeTo:i.route})}),m(8," Anuluj "),o()()()),n&2){let a;l("ngIf",i.isLoading),s(),l("ngIf",i.editPlaceForm),s(3),l("disabled",i.editPlaceForm.invalid||((a=i.editPlaceForm.get("placeName"))==null?null:a.pending))}},dependencies:[v,_,B,k,z,L,T,S,G,R,h,V,H]})}}return e})();var ot=[{path:"",component:je},{path:"new",component:Re},{path:":id/edit",component:Te}],ke=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=x({imports:[X.forChild(ot),X]})}}return e})();var ti=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=x({imports:[ue,ke,_,q,y,W,$,ge,S,h,_e]})}}return e})();export{ti as AdminPanelPlaceModule};
