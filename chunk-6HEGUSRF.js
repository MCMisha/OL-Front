import{a as he}from"./chunk-LN6PN42S.js";import{a as y}from"./chunk-ROEU53K6.js";import{a as Se,c as Ee}from"./chunk-PP5HEX27.js";import{a as V,b as Pe,c as _e,d as be,e as we,f as Ce,g as ve,h as ye,i as H,j as O,l as Me}from"./chunk-ZACR2VZI.js";import{a as B}from"./chunk-LT37DXK5.js";import{a as P}from"./chunk-QY7PK644.js";import{b as v}from"./chunk-HUWHK7CY.js";import{Ba as j,Ca as R,Fa as T,Ga as k,Ha as L,La as z,Ma as fe,Na as ge,S as g,qa as A,ra as F,va as C,ya as D,za as h}from"./chunk-TF66RT5N.js";import"./chunk-6XXA7HXI.js";import"./chunk-BKP4CZB2.js";import{i as I,k as N,l as ue,m as Z}from"./chunk-C5XILQZG.js";import{Ab as u,Bb as W,Cb as q,Eb as ne,Hb as f,Jb as M,Kc as pe,Mc as w,Nb as re,Pb as oe,Pc as de,Qb as le,Rb as me,Tb as m,Ub as Q,V as ee,W as $,Xa as s,Ya as p,ac as se,ba as E,bc as ce,e as _,ga as te,j as Y,la as b,ma as x,nb as d,pb as r,t as S,ta as ie,ua as ae,yb as o,zb as n}from"./chunk-UUB5ROYG.js";var ke=()=>[2,5,10],Le=e=>({highlighted:e});function ze(e,c){e&1&&u(0,"mat-progress-bar",14)}function Be(e,c){e&1&&(o(0,"th",15),m(1,"Id"),n())}function Ve(e,c){if(e&1&&(o(0,"td",16),m(1),n()),e&2){let t=c.$implicit;s(),Q(t.id)}}function He(e,c){e&1&&(o(0,"th",15),m(1,"Nazwa"),n())}function Oe(e,c){if(e&1&&(o(0,"td",16),m(1),n()),e&2){let t=c.$implicit;s(),Q(t.name)}}function Ge(e,c){e&1&&u(0,"tr",17)}function $e(e,c){if(e&1){let t=ne();o(0,"tr",18),f("click",function(){let i=ie(t).$implicit,l=M();return ae(l.highlightRow(i))}),n()}if(e&2){let t=c.$implicit,a=M();r("ngClass",ce(1,Le,a.selectedRowIndex==t.id))}}var De=(()=>{class e{constructor(t,a){this.dialog=t,this.adminPlaceService=a,this.places=[],this.pageSize=5,this.pageIndex=0,this.displayedColumns=["id","name"],this.dataSourceWithPageSize=new Me(this.places),this.subscription=new _,this.destroy$=new Y,this._snackBar=te(he),this.isLoading=!0}ngOnInit(){this.subscription.add(this.adminPlaceService.getPlaces().pipe($(this.destroy$)).subscribe(t=>{this.places=t,this.dataSourceWithPageSize.data=this.places,this.isLoading=!1}))}ngAfterViewInit(){this.paginator?this.dataSourceWithPageSize.paginator=this.paginator:console.error("Paginator is not initialized.")}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}openDialog(){this.dialog.open(Ee,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(a=>{a&&this.deletePlace()})}ngOnDestroy(){this.subscription.unsubscribe()}deletePlace(){this.selectedRow&&this.subscription.add(this.adminPlaceService.deletePlace(this.selectedRow.id).pipe($(this.destroy$)).subscribe(()=>{this.ngOnInit()},t=>{this._snackBar.open(`Bl\u0105d podczas usuni\u0119cia: ${t.error}`,"Zamknij",{duration:5e3})}))}static{this.\u0275fac=function(a){return new(a||e)(p(Se),p(y))}}static{this.\u0275cmp=b({type:e,selectors:[["app-admin-panel-place"]],viewQuery:function(a,i){if(a&1&&oe(v,5),a&2){let l;le(l=me())&&(i.paginator=l.first)}},decls:21,vars:12,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mode","indeterminate",1,"mb-1"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(a,i){a&1&&(d(0,ze,1,0,"mat-progress-bar",0),o(1,"div",1)(2,"div",2)(3,"button",3),m(4,"Dodaj"),n()(),o(5,"div",2)(6,"button",4),m(7,"Edytuj"),n()(),o(8,"div",2)(9,"button",5),f("click",function(){return i.openDialog()}),m(10,"Usu\u0144"),n()()(),o(11,"table",6),W(12,7),d(13,Be,2,0,"th",8)(14,Ve,2,1,"td",9),q(),W(15,10),d(16,He,2,0,"th",8)(17,Oe,2,1,"td",9),q(),d(18,Ge,1,0,"tr",11)(19,$e,1,3,"tr",12),n(),u(20,"mat-paginator",13)),a&2&&(r("ngIf",i.isLoading),s(6),re("routerLink","",i.selectedRow==null?null:i.selectedRow.id,"/edit"),r("disabled",!i.selectedRow),s(3),r("disabled",!i.selectedRow),s(2),r("dataSource",i.dataSourceWithPageSize),s(7),r("matHeaderRowDef",i.displayedColumns),s(),r("matRowDefColumns",i.displayedColumns),s(),r("pageSize",i.pageSize)("pageIndex",i.pageIndex)("pageSizeOptions",se(11,ke)))},dependencies:[pe,w,ue,g,Ce,Pe,be,we,H,ve,v,O,ye,V,_e,P],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}"]})}}return e})();function Ze(e,c){e&1&&u(0,"mat-progress-bar",9)}function Ue(e,c){e&1&&(o(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),n())}function Je(e,c){e&1&&(o(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function Ke(e,c){e&1&&(o(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),n())}function Xe(e,c){e&1&&(o(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),n())}var je=(()=>{class e{constructor(t,a,i,l){this.placeService=t,this.fb=a,this.router=i,this.route=l,this.existingPlaces=[],this.subscription=new _,this.isLoading=!0}ngOnInit(){this.newPlaceForm=this.fb.group({placeName:["",[h.required,h.minLength(3),h.maxLength(50)],[this.placeExistsValidator.bind(this)]]}),this.subscription.add(this.placeService.getPlaces().subscribe(t=>{this.existingPlaces=t,this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}placeExistsValidator(t){return this.placeService.getPlaces().pipe(S(a=>a.some(l=>l.name.toLowerCase()===t.value.toLowerCase())?{placeExists:!0}:null))}savePlace(){if(this.newPlaceForm.valid){let t=this.newPlaceForm.value.placeName;this.placeService.createPlace({id:0,name:t}).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}}static{this.\u0275fac=function(a){return new(a||e)(p(y),p(z),p(N),p(I))}}static{this.\u0275cmp=b({type:e,selectors:[["app-admin-panel-place-new"]],decls:17,vars:7,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"]],template:function(a,i){if(a&1&&(d(0,Ze,1,0,"mat-progress-bar",0),o(1,"form",1)(2,"mat-form-field",2)(3,"mat-label"),m(4,"Nazwa miejsca"),n(),u(5,"input",3),d(6,Ue,2,0,"mat-error",4)(7,Je,2,0,"mat-error",4)(8,Ke,2,0,"mat-error",4)(9,Xe,2,0,"mat-error",4),n()(),o(10,"div",5)(11,"div",6)(12,"button",7),f("click",function(){return i.savePlace()}),m(13," Zapisz "),n()(),o(14,"div",6)(15,"button",8),f("click",function(){return i.router.navigate([".."],{relativeTo:i.route})}),m(16," Anuluj "),n()()()),a&2){let l,U,J,K,X;r("ngIf",i.isLoading),s(),r("formGroup",i.newPlaceForm),s(5),r("ngIf",(l=i.newPlaceForm.get("placeName"))==null?null:l.hasError("required")),s(),r("ngIf",(U=i.newPlaceForm.get("placeName"))==null?null:U.hasError("minlength")),s(),r("ngIf",(J=i.newPlaceForm.get("placeName"))==null?null:J.hasError("maxlength")),s(),r("ngIf",(K=i.newPlaceForm.get("placeName"))==null?null:K.hasError("placeExists")),s(3),r("disabled",i.newPlaceForm.invalid||((X=i.newPlaceForm.get("placeName"))==null?null:X.pending))}},dependencies:[w,g,T,D,j,R,F,C,B,A,P,k,L]})}}return e})();function Ye(e,c){e&1&&u(0,"mat-progress-bar",6)}function et(e,c){e&1&&(o(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),n())}function tt(e,c){e&1&&(o(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function it(e,c){e&1&&(o(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),n())}function at(e,c){e&1&&(o(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),n())}function nt(e,c){if(e&1&&(o(0,"form",7)(1,"mat-form-field",8)(2,"mat-label"),m(3,"Nazwa miejsca"),n(),u(4,"input",9),d(5,et,2,0,"mat-error",10)(6,tt,2,0,"mat-error",10)(7,it,2,0,"mat-error",10)(8,at,2,0,"mat-error",10),n()()),e&2){let t=M();r("formGroup",t.editPlaceForm),s(5),r("ngIf",t.editPlaceForm.get("placeName").hasError("required")),s(),r("ngIf",t.editPlaceForm.get("placeName").hasError("minlength")),s(),r("ngIf",t.editPlaceForm.get("placeName").hasError("maxlength")),s(),r("ngIf",t.editPlaceForm.get("placeName").hasError("placeExists"))}}var Re=(()=>{class e{constructor(t,a,i,l){this.placeService=t,this.fb=a,this.router=i,this.route=l,this.existingPlaces=[],this.subscription=new _,this.placePerformances=[],this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.editPlaceForm=this.fb.group({placeName:["",[h.required,h.minLength(3),h.maxLength(50)],[this.placeExistsValidator.bind(this)]]}),this.subscription.add(this.route.params.pipe(ee(t=>(this.currentPlaceId=+t.id,this.placeService.getPlaces()))).subscribe(t=>{this.existingPlaces=t;let a=t.find(i=>i.id===this.currentPlaceId);a&&this.editPlaceForm.patchValue({placeName:a.name}),this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}placeExistsValidator(t){return this.placeService.getPlaces().pipe(S(a=>a.some(l=>l.name.toLowerCase()===t.value.toLowerCase()&&l.id!==this.currentPlaceId)?{placeExists:!0}:null))}savePlace(){if(this.editPlaceForm.valid){let t=this.editPlaceForm.value.placeName;this.placeService.updatePlace({id:this.currentPlaceId,name:t}).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}}static{this.\u0275fac=function(a){return new(a||e)(p(y),p(z),p(N),p(I))}}static{this.\u0275cmp=b({type:e,selectors:[["app-admin-panel-place-edit"]],decls:9,vars:3,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"],[3,"formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"]],template:function(a,i){if(a&1&&(d(0,Ye,1,0,"mat-progress-bar",0)(1,nt,9,5,"form",1),o(2,"div",2)(3,"div",3)(4,"button",4),f("click",function(){return i.savePlace()}),m(5," Zapisz "),n()(),o(6,"div",3)(7,"button",5),f("click",function(){return i.router.navigate(["../.."],{relativeTo:i.route})}),m(8," Anuluj "),n()()()),a&2){let l;r("ngIf",i.isLoading),s(),r("ngIf",i.editPlaceForm),s(3),r("disabled",i.editPlaceForm.invalid||((l=i.editPlaceForm.get("placeName"))==null?null:l.pending))}},dependencies:[w,g,T,D,j,R,F,C,B,A,P,k,L]})}}return e})();var rt=[{path:"",component:De},{path:"new",component:je},{path:":id/edit",component:Re}],Te=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=x({type:e})}static{this.\u0275inj=E({imports:[Z.forChild(rt),Z]})}}return e})();var ei=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=x({type:e})}static{this.\u0275inj=E({imports:[de,Te,g,H,v,O,V,fe,C,P,ge]})}}return e})();export{ei as AdminPanelPlaceModule};
