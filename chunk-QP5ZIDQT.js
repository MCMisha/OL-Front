import{a as x}from"./chunk-YPJWRUYN.js";import{a as be,b as Ce,c as xe,d as Se,e as ye,f as Ee,g as Me,h as Ae,i as Pe,j as Ie,k as Ne,l as Fe}from"./chunk-MGKQDZTZ.js";import{c as U,d as ve}from"./chunk-WFTMY6JX.js";import{a as W,b as Ge}from"./chunk-QDMGJSZF.js";import{T as C,V as he,fa as R,ga as D,ja as j,la as V,ma as _,oa as z,pa as L,sa as O,ta as B,ua as $,va as H,wa as _e,xa as we,ya as E}from"./chunk-RYMWDD6Z.js";import{a as fe,i as k,k as T,l as ge,m as K}from"./chunk-DD3TWRCF.js";import{$ as P,Bb as N,Eb as u,Gb as h,Hc as ue,Jb as ae,Jc as F,Lb as me,Mb as le,Mc as ce,Nb as se,Pb as s,Qb as J,T as ne,U as q,Ua as l,Va as p,Yb as de,Zb as pe,_ as re,da as oe,e as w,j as ie,ja as v,ka as I,kb as f,mb as m,ra as G,s as A,sa as b,vb as r,wb as o,xb as g,yb as Q,zb as Z}from"./chunk-BI472RZ2.js";var S=(()=>{class e{constructor(t){this.http=t}getGenres(){return this.http.get(`${E.baseApiUri}/AdminGenre/all`)}createGenre(t){return this.http.post(`${E.baseApiUri}/AdminGenre/create`,t)}updateGenre(t){return this.http.put(`${E.baseApiUri}/AdminGenre/update`,t)}deleteGenre(t){return this.http.delete(`${E.baseApiUri}/AdminGenre/delete/${t}`)}static{this.\u0275fac=function(n){return new(n||e)(oe(fe))}}static{this.\u0275prov=re({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Le=()=>[2,5,10],Oe=e=>({highlighted:e});function Be(e,d){e&1&&(r(0,"th",13),s(1,"Id"),o())}function $e(e,d){if(e&1&&(r(0,"td",14),s(1),o()),e&2){let t=d.$implicit;l(),J(t.id)}}function He(e,d){e&1&&(r(0,"th",13),s(1,"Nazwa"),o())}function Ue(e,d){if(e&1&&(r(0,"td",14),s(1),o()),e&2){let t=d.$implicit;l(),J(t.name)}}function We(e,d){e&1&&g(0,"tr",15)}function qe(e,d){if(e&1){let t=N();r(0,"tr",16),u("click",function(){let i=G(t).$implicit,a=h();return b(a.highlightRow(i))}),o()}if(e&2){let t=d.$implicit,n=h();m("ngClass",pe(1,Oe,n.selectedRowIndex==t.id))}}var De=(()=>{class e{constructor(t){this.genreService=t,this.genres=[],this.displayedColumns=["id","name"],this.pageSize=5,this.pageIndex=0,this.paginatedGenres=[],this.dataSourceWithPageSize=new Fe(this.genres),this.subscription=new w,this.destroy$=new ie}ngOnInit(){this.genreService.getGenres().pipe(q(this.destroy$)).subscribe(t=>{this.genres=t,this.dataSourceWithPageSize.data=this.genres})}ngAfterViewInit(){this.paginator?this.dataSourceWithPageSize.paginator=this.paginator:console.error("Paginator is not initialized.")}ngOnDestroy(){this.subscription.unsubscribe()}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}deleteGenre(){this.selectedRow&&this.genreService.deleteGenre(this.selectedRow.id).pipe(q(this.destroy$)).subscribe(()=>{this.ngOnInit()})}static{this.\u0275fac=function(n){return new(n||e)(p(S))}}static{this.\u0275cmp=v({type:e,selectors:[["app-admin-panel-genre"]],viewQuery:function(n,i){if(n&1&&me(U,5),n&2){let a;le(a=se())&&(i.paginator=a.first)}},decls:20,vars:11,consts:[[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(n,i){n&1&&(r(0,"div",0)(1,"div",1)(2,"button",2),s(3,"Dodaj"),o()(),r(4,"div",1)(5,"button",3),s(6,"Edytuj"),o()(),r(7,"div",1)(8,"button",4),u("click",function(){return i.deleteGenre()}),s(9,"Usu\u0144"),o()()(),r(10,"table",5),Q(11,6),f(12,Be,2,0,"th",7)(13,$e,2,1,"td",8),Z(),Q(14,9),f(15,He,2,0,"th",7)(16,Ue,2,1,"td",8),Z(),f(17,We,1,0,"tr",10)(18,qe,1,3,"tr",11),o(),g(19,"mat-paginator",12)),n&2&&(l(5),ae("routerLink","",i.selectedRow==null?null:i.selectedRow.id,"/edit"),m("disabled",!i.selectedRow),l(3),m("disabled",!i.selectedRow),l(2),m("dataSource",i.dataSourceWithPageSize),l(7),m("matHeaderRowDef",i.displayedColumns),l(),m("matRowDefColumns",i.displayedColumns),l(),m("pageSize",i.pageSize)("pageIndex",i.pageIndex)("pageSizeOptions",de(10,Le)))},dependencies:[ue,be,xe,Me,Se,Ce,Ae,ye,Ee,Pe,Ie,ge,U,C],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#00f}mat-sidenav-content[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}table[_ngcontent-%COMP%]{width:100%;max-width:100%}mat-paginator[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}.row[_ngcontent-%COMP%]{width:100%;max-width:100%}"]})}}return e})();function Xe(e,d){e&1&&g(0,"mat-progress-bar",2)}function Ye(e,d){e&1&&(r(0,"mat-error"),s(1," Nazwa gatunku jest wymagana "),o())}function et(e,d){e&1&&(r(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function tt(e,d){e&1&&(r(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function it(e,d){e&1&&(r(0,"mat-error"),s(1," Gatunek ju\u017C istnieje "),o())}function nt(e,d){if(e&1){let t=N();r(0,"div")(1,"form",3),u("ngSubmit",function(){G(t);let i=h();return b(i.saveGenre())}),r(2,"mat-form-field",4)(3,"mat-label"),s(4,"Nazwa gatunku"),o(),g(5,"input",5),f(6,Ye,2,0,"mat-error",1)(7,et,2,0,"mat-error",1)(8,tt,2,0,"mat-error",1)(9,it,2,0,"mat-error",1),o()(),r(10,"div",6)(11,"div",7)(12,"button",8),u("click",function(){G(t);let i=h();return b(i.saveGenre())}),s(13," Zapisz "),o()(),r(14,"div",7)(15,"button",9),u("click",function(){G(t);let i=h();return b(i.router.navigate(["../.."],{relativeTo:i.route}))}),s(16," Anuluj "),o()()()()}if(e&2){let t,n,i,a,y,c=h();l(),m("formGroup",c.editGenreForm),l(5),m("ngIf",(t=c.editGenreForm.get("genreName"))==null?null:t.hasError("required")),l(),m("ngIf",(n=c.editGenreForm.get("genreName"))==null?null:n.hasError("minlength")),l(),m("ngIf",(i=c.editGenreForm.get("genreName"))==null?null:i.hasError("maxlength")),l(),m("ngIf",(a=c.editGenreForm.get("genreName"))==null?null:a.hasError("genreExists")),l(3),m("disabled",c.editGenreForm.invalid||((y=c.editGenreForm.get("genreName"))==null?null:y.pending))}}var je=(()=>{class e{constructor(t,n,i,a){this.genreService=t,this.fb=n,this.router=i,this.route=a,this.existingGenres=[],this.subscription=new w,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.subscription.add(this.route.params.pipe(ne(t=>(this.currentGenreId=+t.id,this.genreService.getGenres()))).subscribe(t=>{this.existingGenres=t;let n=t.find(i=>i.id===this.currentGenreId);n&&(this.editGenreForm=this.fb.group({genreName:[n.name,[_.required,_.minLength(3),_.maxLength(50)],[this.genreExistsValidator.bind(this)]]})),this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}genreExistsValidator(t){return this.genreService.getGenres().pipe(A(n=>n.some(a=>a.name.toLowerCase()===t.value.toLowerCase()&&a.id!==this.currentGenreId)?{genreExists:!0}:null))}saveGenre(){if(this.editGenreForm.valid){let t=this.editGenreForm.value.genreName;this.genreService.updateGenre({id:this.currentGenreId,name:t}).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(S),p(H),p(T),p(k))}}static{this.\u0275cmp=v({type:e,selectors:[["app-admin-panel-genre-edit"]],decls:2,vars:2,consts:[["mode","indeterminate",4,"ngIf"],[4,"ngIf"],["mode","indeterminate"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","genreName","placeholder","Wprowad\u017A nazw\u0119 gatunku"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"]],template:function(n,i){if(n&1&&f(0,Xe,1,0,"mat-progress-bar",0)(1,nt,17,6,"div",1),n&2){let a;m("ngIf",(a=i.editGenreForm.get("genreName"))==null?null:a.pending),l(),m("ngIf",!i.isLoading)}},dependencies:[F,O,V,z,L,B,$,C,W,j,R,D,x]})}}return e})();function rt(e,d){e&1&&g(0,"mat-progress-bar",9)}function ot(e,d){e&1&&(r(0,"mat-error"),s(1," Nazwa gatunku jest wymagana "),o())}function at(e,d){e&1&&(r(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function mt(e,d){e&1&&(r(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function lt(e,d){e&1&&(r(0,"mat-error"),s(1," Gatunek ju\u017C istnieje "),o())}var Ve=(()=>{class e{constructor(t,n,i,a){this.genreService=t,this.fb=n,this.router=i,this.route=a,this.existingGenres=[],this.subscription=new w}ngOnInit(){this.subscription.add(this.genreService.getGenres().subscribe(t=>{this.existingGenres=t})),this.newGenreForm=this.fb.group({genreName:["",[_.required,_.minLength(3),_.maxLength(50)],[this.genreExistsValidator.bind(this)]]})}ngOnDestroy(){this.subscription.unsubscribe()}genreExistsValidator(t){return this.genreService.getGenres().pipe(A(n=>n.some(a=>a.name.toLowerCase()===t.value.toLowerCase())?{genreExists:!0}:null))}saveGenre(){if(this.newGenreForm.valid){let t=this.newGenreForm.value.genreName;this.genreService.createGenre({id:0,name:t}).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(S),p(H),p(T),p(k))}}static{this.\u0275cmp=v({type:e,selectors:[["app-admin-panel-genre-new"]],decls:17,vars:7,consts:[["mode","indeterminate",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","genreName","placeholder","Wprowad\u017A nazw\u0119 gatunku"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate"]],template:function(n,i){if(n&1&&(f(0,rt,1,0,"mat-progress-bar",0),r(1,"form",1),u("ngSubmit",function(){return i.saveGenre()}),r(2,"mat-form-field",2)(3,"mat-label"),s(4,"Nazwa gatunku"),o(),g(5,"input",3),f(6,ot,2,0,"mat-error",4)(7,at,2,0,"mat-error",4)(8,mt,2,0,"mat-error",4)(9,lt,2,0,"mat-error",4),o()(),r(10,"div",5)(11,"div",6)(12,"button",7),u("click",function(){return i.saveGenre()}),s(13," Zapisz "),o()(),r(14,"div",6)(15,"button",8),u("click",function(){return i.router.navigate([".."],{relativeTo:i.route})}),s(16," Anuluj "),o()()()),n&2){let a,y,c,Y,ee,te;m("ngIf",(a=i.newGenreForm.get("genreName"))==null?null:a.pending),l(),m("formGroup",i.newGenreForm),l(5),m("ngIf",(y=i.newGenreForm.get("genreName"))==null?null:y.hasError("required")),l(),m("ngIf",(c=i.newGenreForm.get("genreName"))==null?null:c.hasError("minlength")),l(),m("ngIf",(Y=i.newGenreForm.get("genreName"))==null?null:Y.hasError("maxlength")),l(),m("ngIf",(ee=i.newGenreForm.get("genreName"))==null?null:ee.hasError("genreExists")),l(3),m("disabled",i.newGenreForm.invalid||((te=i.newGenreForm.get("genreName"))==null?null:te.pending))}},dependencies:[F,O,V,z,L,B,$,C,W,j,R,D,x]})}}return e})();var st=[{path:"",component:De},{path:"new",component:Ve},{path:":id/edit",component:je}],ze=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=P({imports:[K.forChild(st),K]})}}return e})();var Ut=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=P({imports:[ce,we,Ne,ze,ve,he,Ge,_e,x]})}}return e})();export{Ut as a};
