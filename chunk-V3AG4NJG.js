import{a as ct,b as pt}from"./chunk-W5E2EOJN.js";import{a as Ce}from"./chunk-HWG3EINT.js";import{a as G}from"./chunk-SNP62HCC.js";import{a as yt,c as bt}from"./chunk-H5ZME2Y7.js";import{a as q}from"./chunk-SKCIPK7T.js";import{a as be,b as dt,c as ut,d as ft,e as ht,f as _t,g as gt,h as vt,i as we,j as Se,l as Pt}from"./chunk-Y5YQ2IGH.js";import{a as j,b as L}from"./chunk-XBWCA7LY.js";import{a as ye,c as z}from"./chunk-XJZG4PQT.js";import{a as B}from"./chunk-GNDO2YSE.js";import{Aa as fe,Ba as he,Ea as _e,Fa as ge,Ga as ve,Ha as Pe,Ja as mt,M as ot,N as rt,O as I,S as O,T as N,a as it,p as nt,qa as ce,ra as pe,sa as de,va as V,xa as ue,ya as h}from"./chunk-HWDLRLPX.js";import{c as at,d as me,e as lt,g as ne,h as st,i as Me}from"./chunk-6XXA7HXI.js";import{a as et,i as le,k as se,l as tt,m as Fe}from"./chunk-ZZO7MJK5.js";import{$b as Qe,Ab as F,Ba as je,Bb as M,Ca as D,Db as A,E as De,Gb as _,Ib as E,Jb as He,Jc as Ze,Kb as $e,Kc as re,Lb as We,Lc as ae,Mb as Oe,Nb as ie,Ob as T,Oc as Je,Pb as k,Qb as y,Rb as a,Sb as x,Tb as b,W as oe,Wa as s,Xa as f,Yb as Ue,Za as Le,Zb as Ke,_b as Ye,aa as Re,ba as ee,da as Ne,e as S,fa as Ve,ib as ze,j as Ee,ka as w,la as C,ma as te,mb as d,nb as qe,ob as m,p as Ie,qb as Be,qc as Xe,rb as Ge,ta as g,ua as v,uc as R,xb as r,yb as i,zb as P}from"./chunk-YKDFZCCH.js";var kt=()=>[2,5,10],xt=e=>({highlighted:e});function Dt(e,l){e&1&&(r(0,"th",17),a(1,"Id"),i())}function Rt(e,l){if(e&1&&(r(0,"td",18),a(1),i()),e&2){let t=l.$implicit;s(),x(t.id)}}function Nt(e,l){e&1&&(r(0,"th",17),a(1,"Nazwa"),i())}function Vt(e,l){if(e&1&&(r(0,"td",18),a(1),i()),e&2){let t=l.$implicit;s(),x(t.title)}}function jt(e,l){e&1&&(r(0,"th",17),a(1,"Gatunek"),i())}function Lt(e,l){if(e&1&&(r(0,"td",18),a(1),i()),e&2){let t=l.$implicit,n=E();s(),x(n.getGenreNameById(t.genre))}}function zt(e,l){e&1&&(r(0,"th",17),a(1,"Miejsce"),i())}function qt(e,l){if(e&1&&(r(0,"td",18),a(1),i()),e&2){let t=l.$implicit,n=E();s(),x(n.getPlaceNameById(t.place))}}function Bt(e,l){e&1&&(r(0,"th",17),a(1,"Czas trwania"),i())}function Gt(e,l){if(e&1&&(r(0,"td",18),a(1),i()),e&2){let t=l.$implicit;s(),x(t.duration)}}function Ht(e,l){e&1&&(r(0,"th",17),a(1,"Ilo\u015B\u0107 przerw"),i())}function $t(e,l){if(e&1&&(r(0,"td",18),a(1),i()),e&2){let t=l.$implicit;s(),x(t.breaksCount)}}function Wt(e,l){e&1&&P(0,"tr",19)}function Ut(e,l){if(e&1){let t=A();r(0,"tr",20),_("click",function(){let o=g(t).$implicit,c=E();return v(c.highlightRow(o))}),i()}if(e&2){let t=l.$implicit,n=E();m("ngClass",Qe(1,xt,n.selectedRowIndex==t.id))}}var Et=(()=>{class e{constructor(t,n,o,c){this.performancesService=t,this.placeService=n,this.genreService=o,this.dialog=c,this.performances=[],this.genres=[],this.places=[],this.displayedColumns=["id","title","genre","place","duration","breaksCount"],this.pageSize=5,this.pageIndex=0,this.paginatedPerfomance=[],this.dataSourceWithPageSize=new Pt(this.performances),this.subscription=new S,this.destroy$=new Ee}ngOnInit(){this.performancesService.getPerformances().pipe(oe(this.destroy$)).subscribe(t=>{this.performances=t,this.dataSourceWithPageSize.data=this.performances}),this.genreService.getGenres().pipe(oe(this.destroy$)).subscribe(t=>{this.genres=t}),this.placeService.getPlaces().pipe(oe(this.destroy$)).subscribe(t=>{this.places=t})}ngAfterViewInit(){this.paginator?this.dataSourceWithPageSize.paginator=this.paginator:console.error("Paginator is not initialized.")}ngOnDestroy(){this.subscription.unsubscribe()}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}getGenreNameById(t){return this.genres.find(o=>o.id===t)?.name??""}getPlaceNameById(t){return this.places.find(o=>o.id===t)?.name??""}openDialog(){this.dialog.open(bt,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(n=>{n&&this.deleteGenre()})}deleteGenre(){this.selectedRow}static{this.\u0275fac=function(n){return new(n||e)(f(ct),f(G),f(pt),f(yt))}}static{this.\u0275cmp=C({type:e,selectors:[["app-admin-panel-performance"]],viewQuery:function(n,o){if(n&1&&ie(L,5),n&2){let c;T(c=k())&&(o.paginator=c.first)}},decls:32,vars:11,consts:[[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","genre"],["matColumnDef","place"],["matColumnDef","duration"],["matColumnDef","breaksCount"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(n,o){n&1&&(r(0,"div",0)(1,"div",1)(2,"button",2),a(3,"Dodaj"),i()(),r(4,"div",1)(5,"button",3),a(6,"Edytuj"),i()(),r(7,"div",1)(8,"button",4),_("click",function(){return o.openDialog()}),a(9,"Usu\u0144"),i()()(),r(10,"table",5),F(11,6),d(12,Dt,2,0,"th",7)(13,Rt,2,1,"td",8),M(),F(14,9),d(15,Nt,2,0,"th",7)(16,Vt,2,1,"td",8),M(),F(17,10),d(18,jt,2,0,"th",7)(19,Lt,2,1,"td",8),M(),F(20,11),d(21,zt,2,0,"th",7)(22,qt,2,1,"td",8),M(),F(23,12),d(24,Bt,2,0,"th",7)(25,Gt,2,1,"td",8),M(),F(26,13),d(27,Ht,2,0,"th",7)(28,$t,2,1,"td",8),M(),d(29,Wt,1,0,"tr",14)(30,Ut,1,3,"tr",15),i(),P(31,"mat-paginator",16)),n&2&&(s(5),We("routerLink","",o.selectedRow==null?null:o.selectedRow.id,"/edit"),m("disabled",!o.selectedRow),s(3),m("disabled",!o.selectedRow),s(2),m("dataSource",o.dataSourceWithPageSize),s(19),m("matHeaderRowDef",o.displayedColumns),s(),m("matRowDefColumns",o.displayedColumns),s(),m("pageSize",o.pageSize)("pageIndex",o.pageIndex)("pageSizeOptions",Ye(10,kt)))},dependencies:[Ze,tt,O,_t,dt,ft,ht,we,gt,L,Se,vt,be,ut],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}mat-sidenav-content[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}table[_ngcontent-%COMP%]{width:100%;max-width:100%}mat-paginator[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}.row[_ngcontent-%COMP%]{width:100%;max-width:100%}"]})}}return e})();var Ae=(()=>{class e{constructor(t){this.http=t}createPerformance(t){return this.http.post(`${z.baseApiUri}/AdminPerformance/new`,t)}getPerformances(){return this.http.get(`${z.baseApiUri}/AdminPerformance/all`).pipe(De(this.handleError("getPerformanceData")))}getPerformanceById(t){return this.http.get(`${z.baseApiUri}/AdminPerformance/${t}`)}updatePerformance(t){return this.http.put(`${z.baseApiUri}/AdminPerformance/update`,t)}deletePerformance(t){return this.http.delete(`${z.baseApiUri}/AdminPerformance/delete/${t}`)}handleError(t="operation",n){return o=>(console.error(o),this.log(`${t} failed: ${o.message}`),Ie(n))}log(t){console.log(`AdminPerformanceService: ${t}`)}static{this.\u0275fac=function(n){return new(n||e)(Ve(et))}}static{this.\u0275prov=Re({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function ti(e,l){e&1&&P(0,"mat-progress-bar",21)}function ii(e,l){e&1&&(r(0,"mat-error"),a(1," Nazwa miejsca jest wymagana "),i())}function ni(e,l){e&1&&(r(0,"mat-error"),a(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),i())}function oi(e,l){e&1&&(r(0,"mat-error"),a(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 256 "),i())}function ri(e,l){e&1&&(r(0,"mat-error"),a(1," Nazwa spektaklu ju\u017C istnieje "),i())}function ai(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t.id),s(),b(" ",t.name," ")}}function li(e,l){e&1&&(r(0,"mat-error"),a(1," Gatunek jest wymagany "),i())}function si(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t.id),s(),b(" ",t.name," ")}}function mi(e,l){e&1&&(r(0,"mat-error"),a(1," Miejsce jest wymagane "),i())}function ci(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t),s(),b(" ",t," ")}}function pi(e,l){e&1&&(r(0,"mat-error"),a(1," Czas trwania jest wymagany "),i())}function di(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t),s(),b(" ",t," ")}}function ui(e,l){e&1&&(r(0,"mat-error"),a(1," Ilo\u015B\u0107 przerw jest wymagana "),i())}function fi(e,l){e&1&&(r(0,"mat-error"),a(1," Opis jest wymagany "),i())}function hi(e,l){e&1&&(r(0,"mat-error"),a(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 5001 znak "),i())}function _i(e,l){e&1&&(r(0,"mat-error"),a(1," G\u0142\xF3wny obraz jest wymagany "),i())}var Ot=(()=>{class e{constructor(t,n,o,c,p,u){this.performanceService=t,this.placeService=n,this.genreService=o,this.fb=c,this.router=p,this.route=u,this.existingPerformances=[],this.subscription=new S,this.places=[],this.genres=[],this.durations=["0:30","1:00","1:30","1:40","2:00","2:30","3:00"],this.breaksCount=[0,1,2,3],this.selectedFiles={mainImage:void 0,poster:void 0},this.selectedFileNames={mainImage:void 0,poster:void 0},this.isFileLoaded={mainImage:!1,poster:!1}}ngOnInit(){this.subscription.add(this.placeService.getPlaces().subscribe(t=>this.places=t)),this.subscription.add(this.genreService.getGenres().subscribe(t=>this.genres=t)),this.subscription.add(this.performanceService.getPerformances().subscribe(t=>this.existingPerformances=t)),this.newPerformanceForm=this.fb.group({title:["",[h.required,h.minLength(3),h.maxLength(255)]],genre:["",[h.required]],place:["",[h.required]],duration:["",[h.required]],breaksCount:["",[h.required]],description:["",[h.required,h.maxLength(5e3)]],mainImage:[null,[h.required]],poster:[null,[h.required]]})}ngOnDestroy(){this.subscription.unsubscribe()}onFileSelected(t,n){let o=t.target;if(o.files&&o.files.length>0){let c=o.files[0];this.selectedFileNames[n]=c.name,this.isFileLoaded[n]=!1;let p=new FileReader;p.readAsDataURL(c),p.onload=()=>{this.selectedFiles[n]=p.result.split(",")[1],this.isFileLoaded[n]=!0,this.newPerformanceForm.patchValue({[n]:c.name}),this.newPerformanceForm.get(n)?.updateValueAndValidity()}}}savePerformance(){if(this.newPerformanceForm.invalid){console.error("Form is invalid or file is still loading!");return}let t={title:this.newPerformanceForm.value.title,genre:this.newPerformanceForm.value.genre,place:this.newPerformanceForm.value.place,duration:this.newPerformanceForm.value.duration,breaksCount:this.newPerformanceForm.value.breaksCount,description:this.newPerformanceForm.value.description,mainImage:this.selectedFiles.mainImage,poster:this.selectedFiles.poster};this.performanceService.createPerformance(t).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}static{this.\u0275fac=function(n){return new(n||e)(f(Ae),f(G),f(Ce),f(Pe),f(se),f(le))}}static{this.\u0275cmp=C({type:e,selectors:[["app-admin-panel-performance-new"]],decls:78,vars:20,consts:[["mainImageInput",""],["posterInput",""],["mode","indeterminate",4,"ngIf"],[3,"formGroup"],[1,"ms-1","mb-1","d-flex","align-items-center"],["appearance","fill",2,"width","500px"],["matInput","","formControlName","title","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],["formControlName","genre"],[3,"value",4,"ngFor","ngForOf"],["formControlName","place"],["formControlName","duration"],["formControlName","breaksCount"],["matInput","","formControlName","description","placeholder","Wprowad\u017A opis"],["type","file","accept","image/*","hidden","",3,"change"],["matInput","","readonly","",3,"click","value"],["mat-icon-button","","matSuffix","",3,"click"],["matSuffix",""],[1,"me-4"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate"],[3,"value"]],template:function(n,o){if(n&1){let c=A();d(0,ti,1,0,"mat-progress-bar",2),r(1,"form",3)(2,"div",4)(3,"mat-form-field",5)(4,"mat-label"),a(5,"Nazwa spektaklu"),i(),P(6,"input",6),d(7,ii,2,0,"mat-error",7)(8,ni,2,0,"mat-error",7)(9,oi,2,0,"mat-error",7)(10,ri,2,0,"mat-error",7),i()(),r(11,"div",4)(12,"mat-form-field",5)(13,"mat-label"),a(14,"Gatunek"),i(),r(15,"mat-select",8),d(16,ai,2,2,"mat-option",9),i(),d(17,li,2,0,"mat-error",7),i()(),r(18,"div",4)(19,"mat-form-field",5)(20,"mat-label"),a(21,"Miejsce"),i(),r(22,"mat-select",10),d(23,si,2,2,"mat-option",9),i(),d(24,mi,2,0,"mat-error",7),i()(),r(25,"div",4)(26,"mat-form-field",5)(27,"mat-label"),a(28,"Czas trwania"),i(),r(29,"mat-select",11),d(30,ci,2,2,"mat-option",9),i(),d(31,pi,2,0,"mat-error",7),i()(),r(32,"div",4)(33,"mat-form-field",5)(34,"mat-label"),a(35,"Ilo\u015B\u0107 przerw"),i(),r(36,"mat-select",12),d(37,di,2,2,"mat-option",9),i(),d(38,ui,2,0,"mat-error",7),i()(),r(39,"div",4)(40,"mat-form-field",5)(41,"mat-label"),a(42,"Opis"),i(),P(43,"textarea",13),d(44,fi,2,0,"mat-error",7)(45,hi,2,0,"mat-error",7),i()(),r(46,"div",4)(47,"mat-form-field",5)(48,"mat-label"),a(49,"G\u0142\xF3wny obraz"),r(50,"sup"),a(51,"*"),i()(),r(52,"input",14,0),_("change",function(u){return g(c),v(o.onFileSelected(u,"mainImage"))}),i(),r(54,"input",15),_("click",function(){g(c);let u=y(53);return v(u.click())}),i(),r(55,"button",16),_("click",function(){g(c);let u=y(53);return v(u.click())}),r(56,"mat-icon",17),a(57,"image"),i()(),d(58,_i,2,0,"mat-error",7),i()(),r(59,"div",4)(60,"mat-form-field",5)(61,"mat-label"),a(62,"Plakat"),r(63,"sup"),a(64,"*"),i()(),r(65,"input",14,1),_("change",function(u){return g(c),v(o.onFileSelected(u,"poster"))}),i(),r(67,"input",15),_("click",function(){g(c);let u=y(66);return v(u.click())}),i(),r(68,"button",16),_("click",function(){g(c);let u=y(66);return v(u.click())}),r(69,"mat-icon",17),a(70,"image"),i()()()()(),r(71,"div",4)(72,"div",18)(73,"button",19),_("click",function(){return g(c),v(o.savePerformance())}),a(74," Zapisz "),i()(),r(75,"div")(76,"button",20),_("click",function(){return g(c),v(o.router.navigate([".."],{relativeTo:o.route}))}),a(77," Anuluj "),i()()()}if(n&2){let c,p,u,$,W,U,K,Y,Q,X,Z,J;m("ngIf",(c=o.newPerformanceForm.get("title"))==null?null:c.pending),s(),m("formGroup",o.newPerformanceForm),s(6),m("ngIf",(p=o.newPerformanceForm.get("title"))==null?null:p.hasError("required")),s(),m("ngIf",(u=o.newPerformanceForm.get("title"))==null?null:u.hasError("minlength")),s(),m("ngIf",($=o.newPerformanceForm.get("title"))==null?null:$.hasError("maxlength")),s(),m("ngIf",(W=o.newPerformanceForm.get("title"))==null?null:W.hasError("placeExists")),s(6),m("ngForOf",o.genres),s(),m("ngIf",(U=o.newPerformanceForm.get("genre"))==null?null:U.hasError("required")),s(6),m("ngForOf",o.places),s(),m("ngIf",(K=o.newPerformanceForm.get("place"))==null?null:K.hasError("required")),s(6),m("ngForOf",o.durations),s(),m("ngIf",(Y=o.newPerformanceForm.get("duration"))==null?null:Y.hasError("required")),s(6),m("ngForOf",o.breaksCount),s(),m("ngIf",(Q=o.newPerformanceForm.get("breaksCount"))==null?null:Q.hasError("required")),s(6),m("ngIf",(X=o.newPerformanceForm.get("description"))==null?null:X.hasError("required")),s(),m("ngIf",(Z=o.newPerformanceForm.get("description"))==null?null:Z.hasError("maxlength")),s(9),m("value",o.selectedFileNames.mainImage||"Nie wybrano pliku"),s(4),m("ngIf",(J=o.newPerformanceForm.get("mainImage"))==null?null:J.hasError("required")),s(9),m("value",o.selectedFileNames.poster||"Nie wybrano pliku"),s(6),m("disabled",o.newPerformanceForm.invalid)}},dependencies:[re,ae,O,pe,V,ye,ce,q,_e,ue,fe,he,ge,ve,j,I,N,B,de],styles:["mat-sidenav-content[_ngcontent-%COMP%]{max-width:80%;overflow-x:hidden}"]})}}return e})();function gi(e,l){e&1&&P(0,"mat-progress-bar",21)}function vi(e,l){e&1&&(r(0,"mat-error"),a(1," Nazwa miejsca jest wymagana "),i())}function Pi(e,l){e&1&&(r(0,"mat-error"),a(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),i())}function yi(e,l){e&1&&(r(0,"mat-error"),a(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 256 "),i())}function bi(e,l){e&1&&(r(0,"mat-error"),a(1," Nazwa spektaklu ju\u017C istnieje "),i())}function wi(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t.id),s(),b(" ",t.name," ")}}function Si(e,l){e&1&&(r(0,"mat-error"),a(1," Gatunek jest wymagany "),i())}function Ci(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t.id),s(),b(" ",t.name," ")}}function Ai(e,l){e&1&&(r(0,"mat-error"),a(1," Miejsce jest wymagane "),i())}function Ei(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t),s(),b(" ",t," ")}}function Ii(e,l){e&1&&(r(0,"mat-error"),a(1," Czas trwania jest wymagany "),i())}function Oi(e,l){if(e&1&&(r(0,"mat-option",22),a(1),i()),e&2){let t=l.$implicit;m("value",t),s(),b(" ",t," ")}}function Fi(e,l){e&1&&(r(0,"mat-error"),a(1," Ilo\u015B\u0107 przerw jest wymagana "),i())}function Mi(e,l){e&1&&(r(0,"mat-error"),a(1," Opis jest wymagany "),i())}function Ti(e,l){e&1&&(r(0,"mat-error"),a(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 5001 znak "),i())}function ki(e,l){e&1&&(r(0,"mat-error"),a(1," G\u0142\xF3wny obraz jest wymagany "),i())}var Ft=(()=>{class e{constructor(t,n,o,c,p,u){this.performanceService=t,this.placeService=n,this.genreService=o,this.fb=c,this.router=p,this.route=u,this.existingPerformances=[],this.subscription=new S,this.places=[],this.genres=[],this.durations=["0:30","1:00","1:30","1:40","2:00","2:30","3:00"],this.breaksCount=[0,1,2,3],this.selectedFiles={mainImage:void 0,poster:void 0},this.selectedFileNames={mainImage:void 0,poster:void 0},this.isFileLoaded={mainImage:!1,poster:!1}}ngOnInit(){let t=+this.route.snapshot.paramMap.get("id");t&&(this.editPerformanceForm=this.fb.group({title:["",[h.required,h.minLength(3),h.maxLength(255)]],genre:["",[h.required]],place:["",[h.required]],duration:["",[h.required]],breaksCount:["",[h.required]],description:["",[h.required,h.maxLength(5e3)]],mainImage:[null,[h.required]],poster:[null,[h.required]]}),this.performanceService.getPerformanceById(t).subscribe(n=>{this.editPerformanceForm.patchValue({title:n.title,genre:n.genre,place:n.place,duration:this.durations.includes(n.duration?.substring(1,5))?n.duration?.substring(1,5):null,breaksCount:this.breaksCount.includes(Number(n?.breaksCount))?Number(n?.breaksCount):null,description:n.description}),this.selectedFiles.mainImage=n.mainImage,this.selectedFiles.poster=n.poster,this.selectedFileNames.mainImage=n.mainImage?"Uploaded Image":void 0,this.selectedFileNames.poster=n.poster?"Uploaded Poster":void 0,this.isFileLoaded.mainImage=!!n.mainImage,this.isFileLoaded.poster=!!n.poster})),this.subscription.add(this.placeService.getPlaces().subscribe(n=>this.places=n)),this.subscription.add(this.genreService.getGenres().subscribe(n=>this.genres=n)),this.subscription.add(this.performanceService.getPerformances().subscribe(n=>this.existingPerformances=n))}ngOnDestroy(){this.subscription.unsubscribe()}onFileSelected(t,n){let o=t.target;if(o.files&&o.files.length>0){let c=o.files[0];this.selectedFileNames[n]=c.name,this.isFileLoaded[n]=!1;let p=new FileReader;p.readAsDataURL(c),p.onload=()=>{this.selectedFiles[n]=p.result.split(",")[1],this.isFileLoaded[n]=!0,this.editPerformanceForm.patchValue({[n]:c.name}),this.editPerformanceForm.get(n)?.updateValueAndValidity()}}}savePerformance(){if(this.editPerformanceForm.invalid){console.error("Form is invalid or file is still loading!");return}let t={title:this.editPerformanceForm.value.title,genre:this.editPerformanceForm.value.genre,place:this.editPerformanceForm.value.place,duration:this.editPerformanceForm.value.duration,breaksCount:this.editPerformanceForm.value.breaksCount,description:this.editPerformanceForm.value.description,mainImage:this.selectedFiles.mainImage,poster:this.selectedFiles.poster};this.performanceService.updatePerformance(t).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}static{this.\u0275fac=function(n){return new(n||e)(f(Ae),f(G),f(Ce),f(Pe),f(se),f(le))}}static{this.\u0275cmp=C({type:e,selectors:[["app-admin-panel-performance-edit"]],decls:78,vars:22,consts:[["mainImageInput",""],["posterInput",""],["mode","indeterminate",4,"ngIf"],[3,"formGroup"],[1,"ms-1","mb-1","d-flex","align-items-center"],["appearance","fill",2,"width","500px"],["matInput","","formControlName","title","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],["formControlName","genre",3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","place",3,"value"],["formControlName","duration"],["formControlName","breaksCount"],["matInput","","formControlName","description","placeholder","Wprowad\u017A opis"],["type","file","accept","image/*","hidden","",3,"change"],["matInput","","readonly","",3,"click","value"],["mat-icon-button","","matSuffix","",3,"click"],["matSuffix",""],[1,"me-4"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate"],[3,"value"]],template:function(n,o){if(n&1){let c=A();d(0,gi,1,0,"mat-progress-bar",2),r(1,"form",3)(2,"div",4)(3,"mat-form-field",5)(4,"mat-label"),a(5,"Nazwa spektaklu"),i(),P(6,"input",6),d(7,vi,2,0,"mat-error",7)(8,Pi,2,0,"mat-error",7)(9,yi,2,0,"mat-error",7)(10,bi,2,0,"mat-error",7),i()(),r(11,"div",4)(12,"mat-form-field",5)(13,"mat-label"),a(14,"Gatunek"),i(),r(15,"mat-select",8),d(16,wi,2,2,"mat-option",9),i(),d(17,Si,2,0,"mat-error",7),i()(),r(18,"div",4)(19,"mat-form-field",5)(20,"mat-label"),a(21,"Miejsce"),i(),r(22,"mat-select",10),d(23,Ci,2,2,"mat-option",9),i(),d(24,Ai,2,0,"mat-error",7),i()(),r(25,"div",4)(26,"mat-form-field",5)(27,"mat-label"),a(28,"Czas trwania"),i(),r(29,"mat-select",11),d(30,Ei,2,2,"mat-option",9),i(),d(31,Ii,2,0,"mat-error",7),i()(),r(32,"div",4)(33,"mat-form-field",5)(34,"mat-label"),a(35,"Ilo\u015B\u0107 przerw"),i(),r(36,"mat-select",12),d(37,Oi,2,2,"mat-option",9),i(),d(38,Fi,2,0,"mat-error",7),i()(),r(39,"div",4)(40,"mat-form-field",5)(41,"mat-label"),a(42,"Opis"),i(),P(43,"textarea",13),d(44,Mi,2,0,"mat-error",7)(45,Ti,2,0,"mat-error",7),i()(),r(46,"div",4)(47,"mat-form-field",5)(48,"mat-label"),a(49,"G\u0142\xF3wny obraz"),r(50,"sup"),a(51,"*"),i()(),r(52,"input",14,0),_("change",function(u){return g(c),v(o.onFileSelected(u,"mainImage"))}),i(),r(54,"input",15),_("click",function(){g(c);let u=y(53);return v(u.click())}),i(),r(55,"button",16),_("click",function(){g(c);let u=y(53);return v(u.click())}),r(56,"mat-icon",17),a(57,"image"),i()(),d(58,ki,2,0,"mat-error",7),i()(),r(59,"div",4)(60,"mat-form-field",5)(61,"mat-label"),a(62,"Plakat"),r(63,"sup"),a(64,"*"),i()(),r(65,"input",14,1),_("change",function(u){return g(c),v(o.onFileSelected(u,"poster"))}),i(),r(67,"input",15),_("click",function(){g(c);let u=y(66);return v(u.click())}),i(),r(68,"button",16),_("click",function(){g(c);let u=y(66);return v(u.click())}),r(69,"mat-icon",17),a(70,"image"),i()()()()(),r(71,"div",4)(72,"div",18)(73,"button",19),_("click",function(){return g(c),v(o.savePerformance())}),a(74," Zapisz "),i()(),r(75,"div")(76,"button",20),_("click",function(){return g(c),v(o.router.navigate([".."],{relativeTo:o.route}))}),a(77," Anuluj "),i()()()}if(n&2){let c,p,u,$,W,U,K,Y,Q,X,Z,J,ke,xe;m("ngIf",(c=o.editPerformanceForm.get("title"))==null?null:c.pending),s(),m("formGroup",o.editPerformanceForm),s(6),m("ngIf",(p=o.editPerformanceForm.get("title"))==null?null:p.hasError("required")),s(),m("ngIf",(u=o.editPerformanceForm.get("title"))==null?null:u.hasError("minlength")),s(),m("ngIf",($=o.editPerformanceForm.get("title"))==null?null:$.hasError("maxlength")),s(),m("ngIf",(W=o.editPerformanceForm.get("title"))==null?null:W.hasError("placeExists")),s(5),m("value",(U=o.editPerformanceForm.get("genre"))==null?null:U.value),s(),m("ngForOf",o.genres),s(),m("ngIf",(K=o.editPerformanceForm.get("genre"))==null?null:K.hasError("required")),s(5),m("value",(Y=o.editPerformanceForm.get("place"))==null?null:Y.value),s(),m("ngForOf",o.places),s(),m("ngIf",(Q=o.editPerformanceForm.get("place"))==null?null:Q.hasError("required")),s(6),m("ngForOf",o.durations),s(),m("ngIf",(X=o.editPerformanceForm.get("duration"))==null?null:X.hasError("required")),s(6),m("ngForOf",o.breaksCount),s(),m("ngIf",(Z=o.editPerformanceForm.get("breaksCount"))==null?null:Z.hasError("required")),s(6),m("ngIf",(J=o.editPerformanceForm.get("description"))==null?null:J.hasError("required")),s(),m("ngIf",(ke=o.editPerformanceForm.get("description"))==null?null:ke.hasError("maxlength")),s(9),m("value",o.selectedFileNames.mainImage||"Nie wybrano pliku"),s(4),m("ngIf",(xe=o.editPerformanceForm.get("mainImage"))==null?null:xe.hasError("required")),s(9),m("value",o.selectedFileNames.poster||"Nie wybrano pliku"),s(6),m("disabled",o.editPerformanceForm.invalid)}},dependencies:[re,ae,O,pe,V,ye,ce,q,_e,ue,fe,he,ge,ve,j,I,N,B,de]})}}return e})();var xi=[{path:"",component:Et},{path:"new",component:Ot},{path:":id/edit",component:Ft}],Mt=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=te({type:e})}static{this.\u0275inj=ee({imports:[Fe.forChild(xi),Fe]})}}return e})();var Di=["panel"],Ri=["*"];function Ni(e,l){if(e&1){let t=A();r(0,"div",1,0),_("@panelAnimation.done",function(o){g(t);let c=E();return v(c._animationDone.next(o))}),$e(2),i()}if(e&2){let t=l.id,n=E();Ge(n._classList),Be("mat-mdc-autocomplete-visible",n.showPanel)("mat-mdc-autocomplete-hidden",!n.showPanel)("mat-primary",n._color==="primary")("mat-accent",n._color==="accent")("mat-warn",n._color==="warn"),m("id",n.id)("@panelAnimation",n.isOpen?"visible":"hidden"),qe("aria-label",n.ariaLabel||null)("aria-labelledby",n._getPanelAriaLabelledby(t))}}var Vi=at("panelAnimation",[st("void, hidden",ne({opacity:0,transform:"scaleY(0.8)"})),Me(":enter, hidden => visible",[lt([me("0.03s linear",ne({opacity:1})),me("0.12s cubic-bezier(0, 0, 0.2, 1)",ne({transform:"scaleY(1)"}))])]),Me(":leave, visible => hidden",[me("0.075s linear",ne({opacity:0}))])]),ji=0,Te=class{constructor(l,t){this.source=l,this.option=t}},Li=new Ne("mat-autocomplete-default-options",{providedIn:"root",factory:zi});function zi(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}var Tt=(()=>{class e{get isOpen(){return this._isOpen&&this.showPanel}_setColor(t){this._color=t,this._changeDetectorRef.markForCheck()}set classList(t){this._classList=t,this._elementRef.nativeElement.className=""}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=t,this._syncParentProperties()}_syncParentProperties(){if(this.options)for(let t of this.options)t._changeDetectorRef.markForCheck()}constructor(t,n,o,c){this._changeDetectorRef=t,this._elementRef=n,this._defaults=o,this._activeOptionChanges=S.EMPTY,this._animationDone=new D,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new D,this.opened=new D,this.closed=new D,this.optionActivated=new D,this.id=`mat-autocomplete-${ji++}`,this.inertGroups=c?.SAFARI||!1,this.autoActiveFirstOption=!!o.autoActiveFirstOption,this.autoSelectActiveOption=!!o.autoSelectActiveOption,this.requireSelection=!!o.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new nt(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(t=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[t]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe(),this._animationDone.complete()}_setScrollTop(t){this.panel&&(this.panel.nativeElement.scrollTop=t)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(t){let n=new Te(this,t);this.optionSelected.emit(n)}_getPanelAriaLabelledby(t){if(this.ariaLabel)return null;let n=t?t+" ":"";return this.ariaLabelledby?n+this.ariaLabelledby:t}_skipPredicate(){return!1}static{this.\u0275fac=function(n){return new(n||e)(f(Xe),f(je),f(Li),f(it))}}static{this.\u0275cmp=C({type:e,selectors:[["mat-autocomplete"]],contentQueries:function(n,o,c){if(n&1&&(Oe(c,I,5),Oe(c,rt,5)),n&2){let p;T(p=k())&&(o.options=p),T(p=k())&&(o.optionGroups=p)}},viewQuery:function(n,o){if(n&1&&(ie(Le,7),ie(Di,5)),n&2){let c;T(c=k())&&(o.template=c.first),T(c=k())&&(o.panel=c.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[w.None,"aria-label","ariaLabel"],ariaLabelledby:[w.None,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[w.HasDecoratorInputTransform,"autoActiveFirstOption","autoActiveFirstOption",R],autoSelectActiveOption:[w.HasDecoratorInputTransform,"autoSelectActiveOption","autoSelectActiveOption",R],requireSelection:[w.HasDecoratorInputTransform,"requireSelection","requireSelection",R],panelWidth:"panelWidth",disableRipple:[w.HasDecoratorInputTransform,"disableRipple","disableRipple",R],classList:[w.None,"class","classList"],hideSingleSelectionIndicator:[w.HasDecoratorInputTransform,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",R]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],standalone:!0,features:[Ue([{provide:ot,useExisting:e}]),ze,Ke],ngContentSelectors:Ri,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(n,o){n&1&&(He(),d(0,Ni,3,16,"ng-template"))},styles:["div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:static;border-radius:var(--mat-autocomplete-container-shape);box-shadow:var(--mat-autocomplete-container-elevation-shadow);background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[Vi]},changeDetection:0})}}return e})();var wo=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=te({type:e})}static{this.\u0275inj=ee({imports:[Je,Mt,O,we,L,Se,be,V,q,mt,j,I,Tt,N,B]})}}return e})();export{wo as AdminPanelPerformanceModule};
