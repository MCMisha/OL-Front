import{a as x}from"./chunk-SKCIPK7T.js";import{a as Re,b as Te,c as je}from"./chunk-KO2X6OK7.js";import{a as xe,b as Se,c as ye,d as Ee,e as Me,f as Ae,g as Ie,h as Pe,i as Ne,j as Fe,k as ke,l as De}from"./chunk-2M6DIGDE.js";import{a as U,b as Ge}from"./chunk-5HU7OLIM.js";import{a as be}from"./chunk-FRV55GM5.js";import{a as W,b as Ce}from"./chunk-TMIP2HPW.js";import{a as E}from"./chunk-BKP4CZB2.js";import{Aa as L,Da as B,Ea as O,Fa as $,Ga as H,Ha as ve,Ia as we,S as b,U as he,qa as R,ra as T,ua as j,wa as z,xa as h,za as V}from"./chunk-SNZU7OSD.js";import{a as ge,i as k,k as D,l as _e,m as K}from"./chunk-ZZO7MJK5.js";import{$b as ue,Ab as Q,Bb as Z,Db as N,Gb as c,Ib as _,Jc as ce,Lb as me,Lc as F,Nb as le,Ob as se,Oc as fe,Pb as de,Rb as l,Sb as J,V as ne,W as q,Wa as m,Xa as p,_b as pe,aa as re,ba as I,e as v,fa as oe,ga as ae,j as ie,la as w,ma as P,mb as u,ob as a,t as A,ta as G,ua as C,xb as r,yb as o,zb as g}from"./chunk-YKDFZCCH.js";var S=(()=>{class e{constructor(t){this.http=t}getGenres(){return this.http.get(`${E.baseApiUri}/AdminGenre/all`)}createGenre(t){return this.http.post(`${E.baseApiUri}/AdminGenre/create`,t)}updateGenre(t){return this.http.put(`${E.baseApiUri}/AdminGenre/update`,t)}deleteGenre(t){return this.http.delete(`${E.baseApiUri}/AdminGenre/delete/${t}`)}static{this.\u0275fac=function(i){return new(i||e)(oe(ge))}}static{this.\u0275prov=re({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ue=()=>[2,5,10],We=e=>({highlighted:e});function qe(e,d){e&1&&(r(0,"th",13),l(1,"Id"),o())}function Qe(e,d){if(e&1&&(r(0,"td",14),l(1),o()),e&2){let t=d.$implicit;m(),J(t.id)}}function Ze(e,d){e&1&&(r(0,"th",13),l(1,"Nazwa"),o())}function Je(e,d){if(e&1&&(r(0,"td",14),l(1),o()),e&2){let t=d.$implicit;m(),J(t.name)}}function Ke(e,d){e&1&&g(0,"tr",15)}function Xe(e,d){if(e&1){let t=N();r(0,"tr",16),c("click",function(){let n=G(t).$implicit,s=_();return C(s.highlightRow(n))}),o()}if(e&2){let t=d.$implicit,i=_();a("ngClass",ue(1,We,i.selectedRowIndex==t.id))}}var Be=(()=>{class e{constructor(t,i){this.genreService=t,this.dialog=i,this.genres=[],this.displayedColumns=["id","name"],this.pageSize=5,this.pageIndex=0,this.paginatedGenres=[],this.dataSourceWithPageSize=new De(this.genres),this.subscription=new v,this.destroy$=new ie,this._snackBar=ae(be)}ngOnInit(){this.genreService.getGenres().pipe(q(this.destroy$)).subscribe(t=>{this.genres=t,this.dataSourceWithPageSize.data=this.genres})}ngAfterViewInit(){this.paginator?this.dataSourceWithPageSize.paginator=this.paginator:console.error("Paginator is not initialized.")}ngOnDestroy(){this.subscription.unsubscribe()}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}openDialog(){this.dialog.open(je,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(i=>{i&&this.deleteGenre()})}deleteGenre(){this.selectedRow&&this.subscription.add(this.genreService.deleteGenre(this.selectedRow.id).pipe(q(this.destroy$)).subscribe(()=>{this.ngOnInit()},t=>{this._snackBar.open(`Bl\u0105d podczas usuni\u0119cia: ${t.error}`,"Zamknij",{duration:5e3})}))}static{this.\u0275fac=function(i){return new(i||e)(p(S),p(Re))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-genre"]],viewQuery:function(i,n){if(i&1&&le(U,5),i&2){let s;se(s=de())&&(n.paginator=s.first)}},decls:20,vars:11,consts:[[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"button",2),l(3,"Dodaj"),o()(),r(4,"div",1)(5,"button",3),l(6,"Edytuj"),o()(),r(7,"div",1)(8,"button",4),c("click",function(){return n.openDialog()}),l(9,"Usu\u0144"),o()()(),r(10,"table",5),Q(11,6),u(12,qe,2,0,"th",7)(13,Qe,2,1,"td",8),Z(),Q(14,9),u(15,Ze,2,0,"th",7)(16,Je,2,1,"td",8),Z(),u(17,Ke,1,0,"tr",10)(18,Xe,1,3,"tr",11),o(),g(19,"mat-paginator",12)),i&2&&(m(5),me("routerLink","",n.selectedRow==null?null:n.selectedRow.id,"/edit"),a("disabled",!n.selectedRow),m(3),a("disabled",!n.selectedRow),m(2),a("dataSource",n.dataSourceWithPageSize),m(7),a("matHeaderRowDef",n.displayedColumns),m(),a("matRowDefColumns",n.displayedColumns),m(),a("pageSize",n.pageSize)("pageIndex",n.pageIndex)("pageSizeOptions",pe(10,Ue)))},dependencies:[ce,xe,ye,Ie,Ee,Se,Pe,Me,Ae,Ne,Fe,_e,U,b],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#00f}mat-sidenav-content[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}table[_ngcontent-%COMP%]{width:100%;max-width:100%}mat-paginator[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}.row[_ngcontent-%COMP%]{width:100%;max-width:100%}"]})}}return e})();function nt(e,d){e&1&&g(0,"mat-progress-bar",2)}function rt(e,d){e&1&&(r(0,"mat-error"),l(1," Nazwa gatunku jest wymagana "),o())}function ot(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function at(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function mt(e,d){e&1&&(r(0,"mat-error"),l(1," Gatunek ju\u017C istnieje "),o())}function lt(e,d){if(e&1){let t=N();r(0,"div")(1,"form",3),c("ngSubmit",function(){G(t);let n=_(2);return C(n.saveGenre())}),r(2,"mat-form-field",4)(3,"mat-label"),l(4,"Nazwa gatunku"),o(),g(5,"input",5),u(6,rt,2,0,"mat-error",0)(7,ot,2,0,"mat-error",0)(8,at,2,0,"mat-error",0)(9,mt,2,0,"mat-error",0),o()(),r(10,"div",6)(11,"div",7)(12,"button",8),c("click",function(){G(t);let n=_(2);return C(n.saveGenre())}),l(13," Zapisz "),o()(),r(14,"div",7)(15,"button",9),c("click",function(){G(t);let n=_(2);return C(n.router.navigate(["../.."],{relativeTo:n.route}))}),l(16," Anuluj "),o()()()()}if(e&2){let t,i,n,s,y,f=_(2);m(),a("formGroup",f.editGenreForm),m(5),a("ngIf",(t=f.editGenreForm.get("genreName"))==null?null:t.hasError("required")),m(),a("ngIf",(i=f.editGenreForm.get("genreName"))==null?null:i.hasError("minlength")),m(),a("ngIf",(n=f.editGenreForm.get("genreName"))==null?null:n.hasError("maxlength")),m(),a("ngIf",(s=f.editGenreForm.get("genreName"))==null?null:s.hasError("genreExists")),m(3),a("disabled",f.editGenreForm.invalid||((y=f.editGenreForm.get("genreName"))==null?null:y.pending))}}function st(e,d){if(e&1&&(r(0,"div"),u(1,nt,1,0,"mat-progress-bar",1)(2,lt,17,6,"div",0),o()),e&2){let t,i=_();m(),a("ngIf",(t=i.editGenreForm.get("genreName"))==null?null:t.pending),m(),a("ngIf",!i.isLoading)}}var Oe=(()=>{class e{constructor(t,i,n,s){this.genreService=t,this.fb=i,this.router=n,this.route=s,this.existingGenres=[],this.subscription=new v,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.subscription.add(this.route.params.pipe(ne(t=>(this.currentGenreId=+t.id,this.genreService.getGenres()))).subscribe(t=>{this.existingGenres=t;let i=t.find(n=>n.id===this.currentGenreId);i&&(this.editGenreForm=this.fb.group({genreName:[i.name,[h.required,h.minLength(3),h.maxLength(50)],[this.genreExistsValidator.bind(this)]]})),this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}genreExistsValidator(t){return this.genreService.getGenres().pipe(A(i=>i.some(s=>s.name.toLowerCase()===t.value.toLowerCase()&&s.id!==this.currentGenreId)?{genreExists:!0}:null))}saveGenre(){if(this.editGenreForm.valid){let t=this.editGenreForm.value.genreName;this.genreService.updateGenre({id:this.currentGenreId,name:t}).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}}static{this.\u0275fac=function(i){return new(i||e)(p(S),p(H),p(D),p(k))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-genre-edit"]],decls:1,vars:1,consts:[[4,"ngIf"],["mode","indeterminate",4,"ngIf"],["mode","indeterminate"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","genreName","placeholder","Wprowad\u017A nazw\u0119 gatunku"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"]],template:function(i,n){i&1&&u(0,st,3,2,"div",0),i&2&&a("ngIf",n.editGenreForm)},dependencies:[F,B,z,V,L,O,$,b,W,j,R,T,x]})}}return e})();function dt(e,d){e&1&&g(0,"mat-progress-bar",9)}function pt(e,d){e&1&&(r(0,"mat-error"),l(1," Nazwa gatunku jest wymagana "),o())}function ut(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function ct(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function ft(e,d){e&1&&(r(0,"mat-error"),l(1," Gatunek ju\u017C istnieje "),o())}var $e=(()=>{class e{constructor(t,i,n,s){this.genreService=t,this.fb=i,this.router=n,this.route=s,this.existingGenres=[],this.subscription=new v}ngOnInit(){this.subscription.add(this.genreService.getGenres().subscribe(t=>{this.existingGenres=t})),this.newGenreForm=this.fb.group({genreName:["",[h.required,h.minLength(3),h.maxLength(50)],[this.genreExistsValidator.bind(this)]]})}ngOnDestroy(){this.subscription.unsubscribe()}genreExistsValidator(t){return this.genreService.getGenres().pipe(A(i=>i.some(s=>s.name.toLowerCase()===t.value.toLowerCase())?{genreExists:!0}:null))}saveGenre(){if(this.newGenreForm.valid){let t=this.newGenreForm.value.genreName;this.genreService.createGenre({id:0,name:t}).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}}static{this.\u0275fac=function(i){return new(i||e)(p(S),p(H),p(D),p(k))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-genre-new"]],decls:17,vars:7,consts:[["mode","indeterminate",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","genreName","placeholder","Wprowad\u017A nazw\u0119 gatunku"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate"]],template:function(i,n){if(i&1&&(u(0,dt,1,0,"mat-progress-bar",0),r(1,"form",1),c("ngSubmit",function(){return n.saveGenre()}),r(2,"mat-form-field",2)(3,"mat-label"),l(4,"Nazwa gatunku"),o(),g(5,"input",3),u(6,pt,2,0,"mat-error",4)(7,ut,2,0,"mat-error",4)(8,ct,2,0,"mat-error",4)(9,ft,2,0,"mat-error",4),o()(),r(10,"div",5)(11,"div",6)(12,"button",7),c("click",function(){return n.saveGenre()}),l(13," Zapisz "),o()(),r(14,"div",6)(15,"button",8),c("click",function(){return n.router.navigate([".."],{relativeTo:n.route})}),l(16," Anuluj "),o()()()),i&2){let s,y,f,Y,ee,te;a("ngIf",(s=n.newGenreForm.get("genreName"))==null?null:s.pending),m(),a("formGroup",n.newGenreForm),m(5),a("ngIf",(y=n.newGenreForm.get("genreName"))==null?null:y.hasError("required")),m(),a("ngIf",(f=n.newGenreForm.get("genreName"))==null?null:f.hasError("minlength")),m(),a("ngIf",(Y=n.newGenreForm.get("genreName"))==null?null:Y.hasError("maxlength")),m(),a("ngIf",(ee=n.newGenreForm.get("genreName"))==null?null:ee.hasError("genreExists")),m(3),a("disabled",n.newGenreForm.invalid||((te=n.newGenreForm.get("genreName"))==null?null:te.pending))}},dependencies:[F,B,z,V,L,O,$,b,W,j,R,T,x]})}}return e})();var gt=[{path:"",component:Be},{path:"new",component:$e},{path:":id/edit",component:Oe}],He=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=P({type:e})}static{this.\u0275inj=I({imports:[K.forChild(gt),K]})}}return e})();var ai=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=P({type:e})}static{this.\u0275inj=I({imports:[fe,we,ke,He,Ge,he,Ce,ve,x,Te]})}}return e})();export{ai as a};
