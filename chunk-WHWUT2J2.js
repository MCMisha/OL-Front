import{a as he}from"./chunk-SBUNVZO2.js";import{a as C}from"./chunk-SVPZ5E3K.js";import{a as xe,b as Ne,c as Ae}from"./chunk-EGWEVUXA.js";import{a as _e,b as be,c as we,d as Ge,e as Ce,f as ve,g as Se,h as ye,i as Me,j as Ee,k as Pe,l as Ie}from"./chunk-5XRSDY3P.js";import{a as O,b as ge}from"./chunk-KAF6YG57.js";import{a as h}from"./chunk-SIWY5EPZ.js";import{b as V,c as fe}from"./chunk-ZPREHPN2.js";import{Aa as R,Ba as T,Ea as j,Fa as L,Ga as z,Ha as B,Ia as ue,Ja as ce,S as G,U as pe,qa as A,ra as F,va as D,xa as k,ya as g}from"./chunk-L27DTTLD.js";import{i as x,k as N,l as de,m as U}from"./chunk-G5IVLWJY.js";import{$b as ae,Ab as f,Bb as W,Cb as q,Eb as te,Hb as c,Jb as Q,Jc as le,Lc as w,Nb as ie,Oc as se,Pb as ne,Qb as re,Rb as oe,Tb as l,Ub as Z,V as K,W as H,Xa as s,Ya as p,ac as me,ba as P,e as _,ga as X,j as J,la as b,ma as I,nb as u,pb as m,t as E,ta as Y,ua as ee,yb as r,zb as o}from"./chunk-DQM3UAK6.js";var Ve=()=>[2,5,10],Oe=e=>({highlighted:e});function $e(e,d){e&1&&f(0,"mat-progress-bar",14)}function He(e,d){e&1&&(r(0,"th",15),l(1,"Id"),o())}function We(e,d){if(e&1&&(r(0,"td",16),l(1),o()),e&2){let i=d.$implicit;s(),Z(i.id)}}function qe(e,d){e&1&&(r(0,"th",15),l(1,"Nazwa"),o())}function Qe(e,d){if(e&1&&(r(0,"td",16),l(1),o()),e&2){let i=d.$implicit;s(),Z(i.name)}}function Ze(e,d){e&1&&f(0,"tr",17)}function Ue(e,d){if(e&1){let i=te();r(0,"tr",18),c("click",function(){let t=Y(i).$implicit,a=Q();return ee(a.highlightRow(t))}),o()}if(e&2){let i=d.$implicit,n=Q();m("ngClass",me(1,Oe,n.selectedRowIndex==i.id))}}var je=(()=>{class e{constructor(i,n){this.genreService=i,this.dialog=n,this.genres=[],this.displayedColumns=["id","name"],this.pageSize=5,this.pageIndex=0,this.paginatedGenres=[],this.dataSourceWithPageSize=new Ie(this.genres),this.subscription=new _,this.destroy$=new J,this._snackBar=X(he),this.isLoading=!0}ngOnInit(){this.genreService.getGenres().pipe(H(this.destroy$)).subscribe(i=>{this.genres=i,this.dataSourceWithPageSize.data=this.genres,this.isLoading=!1})}ngAfterViewInit(){this.paginator?this.dataSourceWithPageSize.paginator=this.paginator:console.error("Paginator is not initialized.")}ngOnDestroy(){this.subscription.unsubscribe()}highlightRow(i){this.selectedRowIndex==i.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=i.id,this.selectedRow=i)}openDialog(){this.dialog.open(Ae,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(n=>{n&&this.deleteGenre()})}deleteGenre(){this.selectedRow&&this.subscription.add(this.genreService.deleteGenre(this.selectedRow.id).pipe(H(this.destroy$)).subscribe(()=>{this.ngOnInit()},i=>{this._snackBar.open(`Bl\u0105d podczas usuni\u0119cia: ${i.error}`,"Zamknij",{duration:5e3})}))}static{this.\u0275fac=function(n){return new(n||e)(p(C),p(xe))}}static{this.\u0275cmp=b({type:e,selectors:[["app-admin-panel-genre"]],viewQuery:function(n,t){if(n&1&&ne(V,5),n&2){let a;re(a=oe())&&(t.paginator=a.first)}},decls:21,vars:12,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mode","indeterminate",1,"mb-1"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(n,t){n&1&&(u(0,$e,1,0,"mat-progress-bar",0),r(1,"div",1)(2,"div",2)(3,"button",3),l(4,"Dodaj"),o()(),r(5,"div",2)(6,"button",4),l(7,"Edytuj"),o()(),r(8,"div",2)(9,"button",5),c("click",function(){return t.openDialog()}),l(10,"Usu\u0144"),o()()(),r(11,"table",6),W(12,7),u(13,He,2,0,"th",8)(14,We,2,1,"td",9),q(),W(15,10),u(16,qe,2,0,"th",8)(17,Qe,2,1,"td",9),q(),u(18,Ze,1,0,"tr",11)(19,Ue,1,3,"tr",12),o(),f(20,"mat-paginator",13)),n&2&&(m("ngIf",t.isLoading),s(6),ie("routerLink","",t.selectedRow==null?null:t.selectedRow.id,"/edit"),m("disabled",!t.selectedRow),s(3),m("disabled",!t.selectedRow),s(2),m("dataSource",t.dataSourceWithPageSize),s(7),m("matHeaderRowDef",t.displayedColumns),s(),m("matRowDefColumns",t.displayedColumns),s(),m("pageSize",t.pageSize)("pageIndex",t.pageIndex)("pageSizeOptions",ae(11,Ve)))},dependencies:[le,w,_e,we,Se,Ge,be,ye,Ce,ve,Me,Ee,de,V,G,h],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}mat-sidenav-content[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}table[_ngcontent-%COMP%]{width:100%;max-width:100%}mat-paginator[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}.row[_ngcontent-%COMP%]{width:100%;max-width:100%}"]})}}return e})();function Ye(e,d){e&1&&f(0,"mat-progress-bar",9)}function et(e,d){e&1&&(r(0,"mat-error"),l(1," Nazwa gatunku jest wymagana "),o())}function tt(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function it(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function nt(e,d){e&1&&(r(0,"mat-error"),l(1," Gatunek ju\u017C istnieje "),o())}var Le=(()=>{class e{constructor(i,n,t,a){this.genreService=i,this.fb=n,this.router=t,this.route=a,this.existingGenres=[],this.subscription=new _,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.editGenreForm=this.fb.group({genreName:["",[g.required,g.minLength(3),g.maxLength(50)],[this.genreExistsValidator.bind(this)]]}),this.subscription.add(this.route.params.pipe(K(i=>(this.currentGenreId=+i.id,this.genreService.getGenres()))).subscribe(i=>{this.existingGenres=i;let n=i.find(t=>t.id===this.currentGenreId);n&&this.editGenreForm.patchValue({genreName:n.name}),this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}genreExistsValidator(i){return this.genreService.getGenres().pipe(E(n=>n.some(a=>a.name.toLowerCase()===i.value.toLowerCase()&&a.id!==this.currentGenreId)?{genreExists:!0}:null))}saveGenre(){if(this.editGenreForm.valid){let i=this.editGenreForm.value.genreName;this.genreService.updateGenre({id:this.currentGenreId,name:i}).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(C),p(B),p(N),p(x))}}static{this.\u0275cmp=b({type:e,selectors:[["app-admin-panel-genre-edit"]],decls:17,vars:7,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","genreName","placeholder","Wprowad\u017A nazw\u0119 gatunku"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"]],template:function(n,t){if(n&1&&(u(0,Ye,1,0,"mat-progress-bar",0),r(1,"form",1),c("ngSubmit",function(){return t.saveGenre()}),r(2,"mat-form-field",2)(3,"mat-label"),l(4,"Nazwa gatunku"),o(),f(5,"input",3),u(6,et,2,0,"mat-error",4)(7,tt,2,0,"mat-error",4)(8,it,2,0,"mat-error",4)(9,nt,2,0,"mat-error",4),o()(),r(10,"div",5)(11,"div",6)(12,"button",7),c("click",function(){return t.saveGenre()}),l(13," Zapisz "),o()(),r(14,"div",6)(15,"button",8),c("click",function(){return t.router.navigate(["../.."],{relativeTo:t.route})}),l(16," Anuluj "),o()()()),n&2){let a,v,S,y,M;m("ngIf",t.isLoading),s(),m("formGroup",t.editGenreForm),s(5),m("ngIf",(a=t.editGenreForm.get("genreName"))==null?null:a.hasError("required")),s(),m("ngIf",(v=t.editGenreForm.get("genreName"))==null?null:v.hasError("minlength")),s(),m("ngIf",(S=t.editGenreForm.get("genreName"))==null?null:S.hasError("maxlength")),s(),m("ngIf",(y=t.editGenreForm.get("genreName"))==null?null:y.hasError("genreExists")),s(3),m("disabled",t.editGenreForm.invalid||((M=t.editGenreForm.get("genreName"))==null?null:M.pending))}},dependencies:[w,j,k,R,T,L,z,G,O,D,A,F,h]})}}return e})();function rt(e,d){e&1&&f(0,"mat-progress-bar",9)}function ot(e,d){e&1&&(r(0,"mat-error"),l(1," Nazwa gatunku jest wymagana "),o())}function at(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),o())}function mt(e,d){e&1&&(r(0,"mat-error"),l(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),o())}function lt(e,d){e&1&&(r(0,"mat-error"),l(1," Gatunek ju\u017C istnieje "),o())}var ze=(()=>{class e{constructor(i,n,t,a){this.genreService=i,this.fb=n,this.router=t,this.route=a,this.existingGenres=[],this.subscription=new _,this.isLoading=!0}ngOnInit(){this.newGenreForm=this.fb.group({genreName:["",[g.required,g.minLength(3),g.maxLength(50)],[this.genreExistsValidator.bind(this)]]}),this.subscription.add(this.genreService.getGenres().subscribe(i=>{this.existingGenres=i,this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}genreExistsValidator(i){return this.genreService.getGenres().pipe(E(n=>n.some(a=>a.name.toLowerCase()===i.value.toLowerCase())?{genreExists:!0}:null))}saveGenre(){if(this.newGenreForm.valid){let i=this.newGenreForm.value.genreName;this.genreService.createGenre({id:0,name:i}).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}}static{this.\u0275fac=function(n){return new(n||e)(p(C),p(B),p(N),p(x))}}static{this.\u0275cmp=b({type:e,selectors:[["app-admin-panel-genre-new"]],decls:17,vars:7,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","genreName","placeholder","Wprowad\u017A nazw\u0119 gatunku"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"]],template:function(n,t){if(n&1&&(u(0,rt,1,0,"mat-progress-bar",0),r(1,"form",1),c("ngSubmit",function(){return t.saveGenre()}),r(2,"mat-form-field",2)(3,"mat-label"),l(4,"Nazwa gatunku"),o(),f(5,"input",3),u(6,ot,2,0,"mat-error",4)(7,at,2,0,"mat-error",4)(8,mt,2,0,"mat-error",4)(9,lt,2,0,"mat-error",4),o()(),r(10,"div",5)(11,"div",6)(12,"button",7),c("click",function(){return t.saveGenre()}),l(13," Zapisz "),o()(),r(14,"div",6)(15,"button",8),c("click",function(){return t.router.navigate([".."],{relativeTo:t.route})}),l(16," Anuluj "),o()()()),n&2){let a,v,S,y,M;m("ngIf",t.isLoading),s(),m("formGroup",t.newGenreForm),s(5),m("ngIf",(a=t.newGenreForm.get("genreName"))==null?null:a.hasError("required")),s(),m("ngIf",(v=t.newGenreForm.get("genreName"))==null?null:v.hasError("minlength")),s(),m("ngIf",(S=t.newGenreForm.get("genreName"))==null?null:S.hasError("maxlength")),s(),m("ngIf",(y=t.newGenreForm.get("genreName"))==null?null:y.hasError("genreExists")),s(3),m("disabled",t.newGenreForm.invalid||((M=t.newGenreForm.get("genreName"))==null?null:M.pending))}},dependencies:[w,j,k,R,T,L,z,G,O,D,A,F,h]})}}return e})();var st=[{path:"",component:je},{path:"new",component:ze},{path:":id/edit",component:Le}],Be=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=P({imports:[U.forChild(st),U]})}}return e})();var Xt=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=P({imports:[se,ce,Pe,Be,fe,pe,ge,ue,h,Ne]})}}return e})();export{Xt as a};
