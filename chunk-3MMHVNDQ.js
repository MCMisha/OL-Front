import{a as M}from"./chunk-CUDEB3KK.js";import{a as Ee,c as Se}from"./chunk-ZZXSNTY4.js";import{a as _}from"./chunk-B2D6ZWPT.js";import{a as H,b as Pe,c as _e,d as be,e as we,f as Ce,g as ve,h as ye,i as O,j as G,l as Me}from"./chunk-DUUEYYWO.js";import{b as y}from"./chunk-5ZK5575K.js";import{a as he}from"./chunk-F635B2SA.js";import{a as V}from"./chunk-GIIDXOVM.js";import{Aa as R,Ba as T,Ea as k,Fa as L,Ga as z,Ha as B,Ia as fe,Ja as ge,S as h,qa as F,ra as D,va as v,xa as j,ya as P}from"./chunk-UILTVVM7.js";import"./chunk-6XXA7HXI.js";import{i as N,k as A,l as ue,m as U}from"./chunk-JD6FLVBJ.js";import{$b as se,Ab as f,Bb as W,Cb as Q,Eb as ne,Hb as g,Jb as E,Kc as pe,Mb as re,Mc as C,Ob as oe,Pb as le,Pc as de,Qb as me,Sb as m,Tb as Z,V as ee,W as q,Xa as s,Ya as p,ac as ce,ba as x,e as b,ga as te,j as Y,la as w,ma as I,nb as u,pb as o,t as S,ta as ie,ua as ae,yb as l,zb as n}from"./chunk-C4UM4IA5.js";var ke=()=>[2,5,10],Le=e=>({highlighted:e});function ze(e,c){e&1&&f(0,"mat-progress-bar",14)}function Be(e,c){e&1&&(l(0,"th",15),m(1,"Id"),n())}function Ve(e,c){if(e&1&&(l(0,"td",16),m(1),n()),e&2){let t=c.$implicit;s(),Z(t.id)}}function He(e,c){e&1&&(l(0,"th",15),m(1,"Nazwa"),n())}function Oe(e,c){if(e&1&&(l(0,"td",16),m(1),n()),e&2){let t=c.$implicit;s(),Z(t.name)}}function Ge(e,c){e&1&&f(0,"tr",17)}function $e(e,c){if(e&1){let t=ne();l(0,"tr",18),g("click",function(){let i=ie(t).$implicit,r=E();return ae(r.highlightRow(i))}),n()}if(e&2){let t=c.$implicit,a=E();o("ngClass",ce(1,Le,a.selectedRowIndex==t.id))}}var De=(()=>{class e{constructor(t,a){this.dialog=t,this.adminPlaceService=a,this.places=[],this.pageSize=5,this.pageIndex=0,this.displayedColumns=["id","name"],this.dataSourceWithPageSize=new Me(this.places),this.subscription=new b,this.destroy$=new Y,this._snackBar=te(he),this.isLoading=!0}ngOnInit(){this.subscription.add(this.adminPlaceService.getPlaces().pipe(q(this.destroy$)).subscribe(t=>{this.places=t,this.dataSourceWithPageSize.data=this.places,this.isLoading=!1}))}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}openDialog(){this.dialog.open(Se,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(a=>{a&&this.deletePlace()})}ngOnDestroy(){this.subscription.unsubscribe()}deletePlace(){this.selectedRow&&this.subscription.add(this.adminPlaceService.deletePlace(this.selectedRow.id).pipe(q(this.destroy$)).subscribe(()=>{this.ngOnInit()},t=>{this._snackBar.open(`Bl\u0105d podczas usuni\u0119cia: ${t.error}`,"Zamknij",{duration:5e3})}))}static{this.\u0275fac=function(a){return new(a||e)(p(Ee),p(M))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-place"]],viewQuery:function(a,i){if(a&1&&oe(y,5),a&2){let r;le(r=me())&&(i.paginator=r.first)}},decls:21,vars:12,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mode","indeterminate",1,"mb-1"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(a,i){a&1&&(u(0,ze,1,0,"mat-progress-bar",0),l(1,"div",1)(2,"div",2)(3,"button",3),m(4,"Dodaj"),n()(),l(5,"div",2)(6,"button",4),m(7,"Edytuj"),n()(),l(8,"div",2)(9,"button",5),g("click",function(){return i.openDialog()}),m(10,"Usu\u0144"),n()()(),l(11,"table",6),W(12,7),u(13,Be,2,0,"th",8)(14,Ve,2,1,"td",9),Q(),W(15,10),u(16,He,2,0,"th",8)(17,Oe,2,1,"td",9),Q(),u(18,Ge,1,0,"tr",11)(19,$e,1,3,"tr",12),n(),f(20,"mat-paginator",13)),a&2&&(o("ngIf",i.isLoading),s(6),re("routerLink","",i.selectedRow==null?null:i.selectedRow.id,"/edit"),o("disabled",!i.selectedRow),s(3),o("disabled",!i.selectedRow),s(2),o("dataSource",i.dataSourceWithPageSize),s(7),o("matHeaderRowDef",i.displayedColumns),s(),o("matRowDefColumns",i.displayedColumns),s(),o("pageSize",i.pageSize)("pageIndex",i.pageIndex)("pageSizeOptions",se(11,ke)))},dependencies:[pe,C,ue,h,Ce,Pe,be,we,O,ve,y,G,ye,H,_e,_],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}"]})}}return e})();function Ze(e,c){e&1&&f(0,"mat-progress-bar",9)}function Ue(e,c){e&1&&(l(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),n())}function Je(e,c){e&1&&(l(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function Ke(e,c){e&1&&(l(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),n())}function Xe(e,c){e&1&&(l(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),n())}var je=(()=>{class e{constructor(t,a,i,r){this.placeService=t,this.fb=a,this.router=i,this.route=r,this.existingPlaces=[],this.subscription=new b,this.isLoading=!0}ngOnInit(){this.newPlaceForm=this.fb.group({placeName:["",[P.required,P.minLength(3),P.maxLength(50)],[this.placeExistsValidator.bind(this)]]}),this.subscription.add(this.placeService.getPlaces().subscribe(t=>{this.existingPlaces=t,this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}placeExistsValidator(t){return this.placeService.getPlaces().pipe(S(a=>a.some(r=>r.name.toLowerCase()===t.value.toLowerCase())?{placeExists:!0}:null))}savePlace(){if(this.newPlaceForm.valid){let t=this.newPlaceForm.value.placeName;this.placeService.createPlace({id:0,name:t}).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}}static{this.\u0275fac=function(a){return new(a||e)(p(M),p(B),p(A),p(N))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-place-new"]],decls:17,vars:7,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"]],template:function(a,i){if(a&1&&(u(0,Ze,1,0,"mat-progress-bar",0),l(1,"form",1)(2,"mat-form-field",2)(3,"mat-label"),m(4,"Nazwa miejsca"),n(),f(5,"input",3),u(6,Ue,2,0,"mat-error",4)(7,Je,2,0,"mat-error",4)(8,Ke,2,0,"mat-error",4)(9,Xe,2,0,"mat-error",4),n()(),l(10,"div",5)(11,"div",6)(12,"button",7),g("click",function(){return i.savePlace()}),m(13," Zapisz "),n()(),l(14,"div",6)(15,"button",8),g("click",function(){return i.router.navigate([".."],{relativeTo:i.route})}),m(16," Anuluj "),n()()()),a&2){let r,d,J,K,X;o("ngIf",i.isLoading),s(),o("formGroup",i.newPlaceForm),s(5),o("ngIf",(r=i.newPlaceForm.get("placeName"))==null?null:r.hasError("required")),s(),o("ngIf",(d=i.newPlaceForm.get("placeName"))==null?null:d.hasError("minlength")),s(),o("ngIf",(J=i.newPlaceForm.get("placeName"))==null?null:J.hasError("maxlength")),s(),o("ngIf",(K=i.newPlaceForm.get("placeName"))==null?null:K.hasError("placeExists")),s(3),o("disabled",i.newPlaceForm.invalid||((X=i.newPlaceForm.get("placeName"))==null?null:X.pending))}},dependencies:[C,h,k,j,R,T,D,v,V,F,_,L,z]})}}return e})();function Ye(e,c){e&1&&f(0,"mat-progress-bar",6)}function et(e,c){e&1&&(l(0,"mat-error"),m(1," Nazwa miejsca jest wymagana "),n())}function tt(e,c){e&1&&(l(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function it(e,c){e&1&&(l(0,"mat-error"),m(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 51 "),n())}function at(e,c){e&1&&(l(0,"mat-error"),m(1," Miejsce ju\u017C istnieje "),n())}function nt(e,c){if(e&1&&(l(0,"form",7)(1,"mat-form-field",8)(2,"mat-label"),m(3,"Nazwa miejsca"),n(),f(4,"input",9),u(5,et,2,0,"mat-error",10)(6,tt,2,0,"mat-error",10)(7,it,2,0,"mat-error",10)(8,at,2,0,"mat-error",10),n()()),e&2){let t,a,i,r,d=E();o("formGroup",d.editPlaceForm),s(5),o("ngIf",d.editPlaceForm==null||(t=d.editPlaceForm.get("placeName"))==null?null:t.hasError("required")),s(),o("ngIf",d.editPlaceForm==null||(a=d.editPlaceForm.get("placeName"))==null?null:a.hasError("minlength")),s(),o("ngIf",d.editPlaceForm==null||(i=d.editPlaceForm.get("placeName"))==null?null:i.hasError("maxlength")),s(),o("ngIf",d.editPlaceForm==null||(r=d.editPlaceForm.get("placeName"))==null?null:r.hasError("placeExists"))}}var Re=(()=>{class e{constructor(t,a,i,r){this.placeService=t,this.fb=a,this.router=i,this.route=r,this.existingPlaces=[],this.subscription=new b,this.placePerformances=[],this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.editPlaceForm=this.fb.group({placeName:["",[P.required,P.minLength(3),P.maxLength(50)],[this.placeExistsValidator.bind(this)]]}),this.subscription.add(this.route.params.pipe(ee(t=>(this.currentPlaceId=+t.id,this.placeService.getPlaces()))).subscribe(t=>{this.existingPlaces=t;let a=t.find(i=>i.id===this.currentPlaceId);a&&this.editPlaceForm.patchValue({placeName:a.name}),this.isLoading=!1}))}ngOnDestroy(){this.subscription.unsubscribe()}placeExistsValidator(t){return this.placeService.getPlaces().pipe(S(a=>a.some(r=>r.name.toLowerCase()===t.value.toLowerCase()&&r.id!==this.currentPlaceId)?{placeExists:!0}:null))}savePlace(){if(this.editPlaceForm.valid){let t=this.editPlaceForm.value.placeName;this.placeService.updatePlace({id:this.currentPlaceId,name:t}).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}}static{this.\u0275fac=function(a){return new(a||e)(p(M),p(B),p(A),p(N))}}static{this.\u0275cmp=w({type:e,selectors:[["app-admin-panel-place-edit"]],decls:9,vars:3,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"row","ms-1","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","type","submit",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"],[3,"formGroup"],["appearance","fill",2,"width","300px"],["matInput","","formControlName","placeName","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"]],template:function(a,i){if(a&1&&(u(0,Ye,1,0,"mat-progress-bar",0)(1,nt,9,5,"form",1),l(2,"div",2)(3,"div",3)(4,"button",4),g("click",function(){return i.savePlace()}),m(5," Zapisz "),n()(),l(6,"div",3)(7,"button",5),g("click",function(){return i.router.navigate(["../.."],{relativeTo:i.route})}),m(8," Anuluj "),n()()()),a&2){let r;o("ngIf",i.isLoading),s(),o("ngIf",i.editPlaceForm),s(3),o("disabled",i.editPlaceForm.invalid||((r=i.editPlaceForm.get("placeName"))==null?null:r.pending))}},dependencies:[C,h,k,j,R,T,D,v,V,F,_,L,z]})}}return e})();var rt=[{path:"",component:De},{path:"new",component:je},{path:":id/edit",component:Re}],Te=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=x({imports:[U.forChild(rt),U]})}}return e})();var ei=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=x({imports:[de,Te,h,O,y,G,H,fe,v,_,ge]})}}return e})();export{ei as AdminPanelPlaceModule};
