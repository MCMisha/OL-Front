import{a as ut}from"./chunk-PWU7PBFR.js";import{a as Ee}from"./chunk-SVPZ5E3K.js";import{a as W}from"./chunk-EENAQQ6H.js";import{a as $}from"./chunk-WZF2H5BH.js";import{a as wt,c as Ct}from"./chunk-ZSGQ574M.js";import{a as Se,b as ft,c as ht,d as _t,e as gt,f as vt,g as Pt,h as yt,i as Ie,j as Ae,l as bt}from"./chunk-5NUJBZGR.js";import{a as Ce}from"./chunk-L5GEZE5Y.js";import{a as O}from"./chunk-SIWY5EPZ.js";import{a as B,b as G}from"./chunk-E52NFQY5.js";import{a as H}from"./chunk-BKP4CZB2.js";import{Ba as ge,Ca as ve,Fa as Pe,Ga as ye,Ha as be,La as we,M as lt,N as st,Na as dt,O as E,S as F,T as z,a as rt,p as at,qa as ue,ra as fe,sa as he,va as q,ya as _e,za as v}from"./chunk-Q53X4CUR.js";import{c as mt,d as de,e as ct,g as le,h as pt,i as Te}from"./chunk-6XXA7HXI.js";import{a as nt,i as ce,k as pe,l as ot,m as xe}from"./chunk-G5IVLWJY.js";import{$b as Ze,Ab as y,Ba as qe,Bb as x,Ca as R,Cb as T,E as Ve,Eb as b,Hb as u,Jb as P,Jc as tt,Kb as Ue,Kc as me,Lb as Ke,Lc as L,Nb as Ye,Ob as ke,Oc as it,Pb as ae,Qb as M,Rb as N,Sb as w,Tb as s,Ua as V,Ub as D,Vb as C,W as ne,Xa as a,Ya as g,Zb as Qe,_a as Be,_b as Xe,aa as je,ac as Je,ba as oe,da as Le,e as I,fa as ze,j as Fe,jb as Ge,ka as S,la as A,ma as re,nb as p,ob as He,p as Oe,pb as l,qc as et,rb as $e,sb as We,ta as f,ua as h,uc as j,yb as o,z as Re,zb as n}from"./chunk-DQM3UAK6.js";var K=(()=>{class e{constructor(t){this.http=t}createPerformance(t){return this.http.post(`${H.baseApiUri}/AdminPerformance/new`,t,{withCredentials:!0})}getPerformances(){return this.http.get(`${H.baseApiUri}/AdminPerformance/all`,{withCredentials:!0}).pipe(Ve(this.handleError("getPerformanceData")))}getPerformanceById(t){return this.http.get(`${H.baseApiUri}/AdminPerformance/${t}`,{withCredentials:!0})}updatePerformance(t){return this.http.put(`${H.baseApiUri}/AdminPerformance/update`,t,{withCredentials:!0})}deletePerformance(t){return this.http.delete(`${H.baseApiUri}/AdminPerformance/delete/${t}`,{withCredentials:!0})}handleError(t="operation",r){return i=>(console.error(i),this.log(`${t} failed: ${i.message}`),Oe(r))}log(t){console.log(`AdminPerformanceService: ${t}`)}static{this.\u0275fac=function(r){return new(r||e)(ze(nt))}}static{this.\u0275prov=je({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Nt=()=>[2,5,10],Dt=e=>({highlighted:e});function Rt(e,m){e&1&&y(0,"mat-progress-bar",18)}function Vt(e,m){e&1&&(o(0,"th",19),s(1,"Id"),n())}function jt(e,m){if(e&1&&(o(0,"td",20),s(1),n()),e&2){let t=m.$implicit;a(),D(t.id)}}function Lt(e,m){e&1&&(o(0,"th",19),s(1,"Nazwa"),n())}function zt(e,m){if(e&1&&(o(0,"td",20),s(1),n()),e&2){let t=m.$implicit;a(),D(t.title)}}function qt(e,m){e&1&&(o(0,"th",19),s(1,"Gatunek"),n())}function Bt(e,m){if(e&1&&(o(0,"td",20),s(1),n()),e&2){let t=m.$implicit,r=P();a(),D(r.getGenreNameById(t.genre))}}function Gt(e,m){e&1&&(o(0,"th",19),s(1,"Miejsce"),n())}function Ht(e,m){if(e&1&&(o(0,"td",20),s(1),n()),e&2){let t=m.$implicit,r=P();a(),D(r.getPlaceNameById(t.place))}}function $t(e,m){e&1&&(o(0,"th",19),s(1,"Czas trwania"),n())}function Wt(e,m){if(e&1&&(o(0,"td",20),s(1),n()),e&2){let t=m.$implicit;a(),D(t.duration)}}function Ut(e,m){e&1&&(o(0,"th",19),s(1,"Ilo\u015B\u0107 przerw"),n())}function Kt(e,m){if(e&1&&(o(0,"td",20),s(1),n()),e&2){let t=m.$implicit;a(),D(t.breaksCount)}}function Yt(e,m){e&1&&y(0,"tr",21)}function Qt(e,m){if(e&1){let t=b();o(0,"tr",22),u("click",function(){let i=f(t).$implicit,c=P();return h(c.highlightRow(i))}),n()}if(e&2){let t=m.$implicit,r=P();l("ngClass",Je(1,Dt,r.selectedRowIndex==t.id))}}var Ot=(()=>{class e{constructor(t,r,i,c){this.performancesService=t,this.placeService=r,this.genreService=i,this.dialog=c,this.performances=[],this.genres=[],this.places=[],this.displayedColumns=["id","title","genre","place","duration","breaksCount"],this.pageSize=5,this.pageIndex=0,this.paginatedPerfomance=[],this.dataSourceWithPageSize=new bt(this.performances),this.subscription=new I,this.destroy$=new Fe,this.isLoading=!0}ngOnInit(){this.subscription.add(this.performancesService.getPerformances().pipe(ne(this.destroy$)).subscribe(t=>{this.performances=t,this.dataSourceWithPageSize.data=this.performances})),this.subscription.add(this.genreService.getGenres().pipe(ne(this.destroy$)).subscribe(t=>{this.genres=t})),this.subscription.add(this.placeService.getPlaces().pipe(ne(this.destroy$)).subscribe(t=>{this.places=t,this.isLoading=!1}))}ngAfterViewInit(){this.paginator?this.dataSourceWithPageSize.paginator=this.paginator:console.error("Paginator is not initialized.")}ngOnDestroy(){this.subscription.unsubscribe()}highlightRow(t){this.selectedRowIndex==t.id?(this.selectedRowIndex=0,this.selectedRow=void 0):(this.selectedRowIndex=t.id,this.selectedRow=t)}getGenreNameById(t){return this.genres.find(i=>i.id===t)?.name??""}getPlaceNameById(t){return this.places.find(i=>i.id===t)?.name??""}openDialog(){this.dialog.open(Ct,{width:"300px",data:{message:"Czy na pewno chcesz usun\u0105\u0107 ten element?"}}).afterClosed().subscribe(r=>{r&&this.deleteGenre()})}deleteGenre(){this.selectedRow&&this.performancesService.deletePerformance(this.selectedRow.id).pipe(ne(this.destroy$)).subscribe(()=>{this.selectedRowIndex=-1,this.selectedRow=void 0,this.ngOnInit()})}static{this.\u0275fac=function(r){return new(r||e)(g(K),g(W),g(ut),g(wt))}}static{this.\u0275cmp=A({type:e,selectors:[["app-admin-panel-performance"]],viewQuery:function(r,i){if(r&1&&ae(G,5),r&2){let c;M(c=N())&&(i.paginator=c.first)}},decls:33,vars:12,consts:[["class","mb-1","mode","indeterminate",4,"ngIf"],[1,"row","mb-1","d-flex","align-items-center"],[1,"col-auto"],["mat-flat-button","","color","primary","routerLink","new",1,"me-2"],["mat-flat-button","","color","accent",1,"me-2",3,"routerLink","disabled"],["mat-flat-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z8","pe-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","genre"],["matColumnDef","place"],["matColumnDef","duration"],["matColumnDef","breaksCount"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageIndex","pageSizeOptions"],["mode","indeterminate",1,"mb-1"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(r,i){r&1&&(p(0,Rt,1,0,"mat-progress-bar",0),o(1,"div",1)(2,"div",2)(3,"button",3),s(4,"Dodaj"),n()(),o(5,"div",2)(6,"button",4),s(7,"Edytuj"),n()(),o(8,"div",2)(9,"button",5),u("click",function(){return i.openDialog()}),s(10,"Usu\u0144"),n()()(),o(11,"table",6),x(12,7),p(13,Vt,2,0,"th",8)(14,jt,2,1,"td",9),T(),x(15,10),p(16,Lt,2,0,"th",8)(17,zt,2,1,"td",9),T(),x(18,11),p(19,qt,2,0,"th",8)(20,Bt,2,1,"td",9),T(),x(21,12),p(22,Gt,2,0,"th",8)(23,Ht,2,1,"td",9),T(),x(24,13),p(25,$t,2,0,"th",8)(26,Wt,2,1,"td",9),T(),x(27,14),p(28,Ut,2,0,"th",8)(29,Kt,2,1,"td",9),T(),p(30,Yt,1,0,"tr",15)(31,Qt,1,3,"tr",16),n(),y(32,"mat-paginator",17)),r&2&&(l("ngIf",i.isLoading),a(6),Ye("routerLink","",i.selectedRow==null?null:i.selectedRow.id,"/edit"),l("disabled",!i.selectedRow),a(3),l("disabled",!i.selectedRow),a(2),l("dataSource",i.dataSourceWithPageSize),a(19),l("matHeaderRowDef",i.displayedColumns),a(),l("matRowDefColumns",i.displayedColumns),a(),l("pageSize",i.pageSize)("pageIndex",i.pageIndex)("pageSizeOptions",Ze(11,Nt)))},dependencies:[tt,L,ot,F,vt,ft,_t,gt,Ie,Pt,G,Ae,yt,Se,ht,O],styles:[".highlighted[_ngcontent-%COMP%]{background-color:#4adcf6f2}mat-sidenav-content[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}table[_ngcontent-%COMP%]{width:100%;max-width:100%}mat-paginator[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{max-width:100%;overflow-x:hidden}.row[_ngcontent-%COMP%]{width:100%;max-width:100%}"]})}}return e})();function ni(e,m){e&1&&y(0,"mat-progress-bar",23)}function oi(e,m){e&1&&(o(0,"mat-error"),s(1," Nazwa miejsca jest wymagana "),n())}function ri(e,m){e&1&&(o(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function ai(e,m){e&1&&(o(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 256 "),n())}function li(e,m){e&1&&(o(0,"mat-error"),s(1," Nazwa spektaklu ju\u017C istnieje "),n())}function si(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t.id),a(),C(" ",t.name," ")}}function mi(e,m){e&1&&(o(0,"mat-error"),s(1," Gatunek jest wymagany "),n())}function ci(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t.id),a(),C(" ",t.name," ")}}function pi(e,m){e&1&&(o(0,"mat-error"),s(1," Miejsce jest wymagane "),n())}function di(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t),a(),C(" ",t," ")}}function ui(e,m){e&1&&(o(0,"mat-error"),s(1," Czas trwania jest wymagany "),n())}function fi(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t),a(),C(" ",t," ")}}function hi(e,m){e&1&&(o(0,"mat-error"),s(1," Ilo\u015B\u0107 przerw jest wymagana "),n())}function _i(e,m){e&1&&(o(0,"mat-error"),s(1," Opis jest wymagany "),n())}function gi(e,m){e&1&&(o(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 5001 znak "),n())}function vi(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t),P();let i=w(51);return h(i.click())}),o(1,"mat-icon",26),s(2,"image"),n()()}}function Pi(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t);let i=P();return h(i.onDeleteImage("mainImage"))}),o(1,"mat-icon",26),s(2,"delete"),n()()}}function yi(e,m){e&1&&(o(0,"mat-error"),s(1," G\u0142\xF3wny obraz jest wymagany "),n())}function bi(e,m){if(e&1&&(o(0,"div",4),y(1,"img",27),n()),e&2){let t=P();a(),l("src",t.mainImage,V)}}function wi(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t),P();let i=w(62);return h(i.click())}),o(1,"mat-icon",26),s(2,"image"),n()()}}function Ci(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t);let i=P();return h(i.onDeleteImage("poster"))}),o(1,"mat-icon",26),s(2,"delete"),n()()}}function Si(e,m){if(e&1&&(o(0,"div",4),y(1,"img",28),n()),e&2){let t=P();a(),l("src",t.poster,V)}}function Ii(e,m){e&1&&(o(0,"mat-error"),s(1," Identyfikator jest wymagany "),n())}var kt=(()=>{class e{constructor(t,r,i,c,d,_){this.performanceService=t,this.placeService=r,this.genreService=i,this.fb=c,this.router=d,this.route=_,this.existingPerformances=[],this.subscription=new I,this.mainImage="data:image/jpeg;base64,",this.poster="data:image/jpeg;base64,",this.places=[],this.genres=[],this.durations=["0:30","1:00","1:30","1:40","2:00","2:30","3:00"],this.breaksCount=[0,1,2,3],this.selectedFiles={mainImage:void 0,poster:void 0},this.selectedFileNames={mainImage:void 0,poster:void 0},this.isFileLoaded={mainImage:!1,poster:!1},this.isLoading=!0}ngOnInit(){this.subscription.add(this.placeService.getPlaces().subscribe(t=>this.places=t)),this.subscription.add(this.genreService.getGenres().subscribe(t=>this.genres=t)),this.subscription.add(this.performanceService.getPerformances().subscribe(t=>{this.existingPerformances=t,this.isLoading=!1})),this.newPerformanceForm=this.fb.group({title:["",[v.required,v.minLength(3),v.maxLength(255)]],genre:["",[v.required]],place:["",[v.required]],duration:["",[v.required]],breaksCount:["",[v.required]],description:["",[v.required,v.maxLength(5e3)]],mainImage:[null,[v.required]],poster:[null],externalId:["",[v.required]]})}ngOnDestroy(){this.subscription.unsubscribe()}onFileSelected(t,r){let i=t.target;if(!i.files||i.files.length===0)return;let c=i.files[0];this.selectedFileNames[r]=c.name,this.isFileLoaded[r]=!1;let d=new FileReader;d.readAsDataURL(c),d.onload=()=>{this.selectedFiles[r]=d.result.split(",")[1],this[r]=d.result,this.isFileLoaded[r]=!0,this.newPerformanceForm.patchValue({[r]:c.name}),this.newPerformanceForm.get(r)?.updateValueAndValidity()},i.value=""}savePerformance(){if(this.newPerformanceForm.invalid){console.error("Formularz jest nieprawid\u0142owy lub plik nadal si\u0119 \u0142aduje!");return}let t={title:this.newPerformanceForm.value.title,genre:this.newPerformanceForm.value.genre,place:this.newPerformanceForm.value.place,duration:this.newPerformanceForm.value.duration,breaksCount:this.newPerformanceForm.value.breaksCount,description:this.newPerformanceForm.value.description,mainImage:this.selectedFiles.mainImage,poster:this.selectedFiles.poster,externalId:this.newPerformanceForm.value.externalId};this.performanceService.createPerformance(t).subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}onDeleteImage(t){this.selectedFiles[t]=void 0,this.selectedFileNames[t]=void 0,this.isFileLoaded[t]=!1,this.newPerformanceForm.patchValue({[t]:null}),this.newPerformanceForm.get(t)?.updateValueAndValidity(),this[t]=""}static{this.\u0275fac=function(r){return new(r||e)(g(K),g(W),g(Ee),g(we),g(pe),g(ce))}}static{this.\u0275cmp=A({type:e,selectors:[["app-admin-panel-performance-new"]],decls:80,vars:27,consts:[["mainImageInput",""],["posterInput",""],["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup"],[1,"ms-1","mb-1","d-flex","align-items-center"],["appearance","fill",2,"width","500px"],["matInput","","formControlName","title","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],["formControlName","genre"],[3,"value",4,"ngFor","ngForOf"],["formControlName","place"],["formControlName","duration"],["formControlName","breaksCount"],["matInput","","formControlName","description","placeholder","Wprowad\u017A opis"],["type","file","accept","image/*","hidden","",3,"change"],["matInput","","required","","readonly","",3,"click","value"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["class","ms-1 mb-1 d-flex align-items-center",4,"ngIf"],["matInput","","readonly","",3,"click","value"],["matInput","","formControlName","externalId","placeholder","Wprowad\u017A identyfikator"],[1,"me-4"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"],[3,"value"],["mat-icon-button","","matSuffix","",3,"click"],["matSuffix",""],["width","25%","height","25%","alt","G\u0142\xF3wny obraz",3,"src"],["width","25%","height","25%","alt","Plakat",3,"src"]],template:function(r,i){if(r&1){let c=b();p(0,ni,1,0,"mat-progress-bar",2),o(1,"form",3)(2,"div",4)(3,"mat-form-field",5)(4,"mat-label"),s(5,"Nazwa spektaklu"),n(),y(6,"input",6),p(7,oi,2,0,"mat-error",7)(8,ri,2,0,"mat-error",7)(9,ai,2,0,"mat-error",7)(10,li,2,0,"mat-error",7),n()(),o(11,"div",4)(12,"mat-form-field",5)(13,"mat-label"),s(14,"Gatunek"),n(),o(15,"mat-select",8),p(16,si,2,2,"mat-option",9),n(),p(17,mi,2,0,"mat-error",7),n()(),o(18,"div",4)(19,"mat-form-field",5)(20,"mat-label"),s(21,"Miejsce"),n(),o(22,"mat-select",10),p(23,ci,2,2,"mat-option",9),n(),p(24,pi,2,0,"mat-error",7),n()(),o(25,"div",4)(26,"mat-form-field",5)(27,"mat-label"),s(28,"Czas trwania"),n(),o(29,"mat-select",11),p(30,di,2,2,"mat-option",9),n(),p(31,ui,2,0,"mat-error",7),n()(),o(32,"div",4)(33,"mat-form-field",5)(34,"mat-label"),s(35,"Ilo\u015B\u0107 przerw"),n(),o(36,"mat-select",12),p(37,fi,2,2,"mat-option",9),n(),p(38,hi,2,0,"mat-error",7),n()(),o(39,"div",4)(40,"mat-form-field",5)(41,"mat-label"),s(42,"Opis"),n(),y(43,"textarea",13),p(44,_i,2,0,"mat-error",7)(45,gi,2,0,"mat-error",7),n()(),o(46,"div",4)(47,"mat-form-field",5)(48,"mat-label"),s(49,"G\u0142\xF3wny obraz"),n(),o(50,"input",14,0),u("change",function(_){return f(c),h(i.onFileSelected(_,"mainImage"))}),n(),o(52,"input",15),u("click",function(){f(c);let _=w(51);return h(_.click())}),n(),p(53,vi,3,0,"button",16)(54,Pi,3,0,"button",16)(55,yi,2,0,"mat-error",7),n()(),p(56,bi,2,1,"div",17),o(57,"div",4)(58,"mat-form-field",5)(59,"mat-label"),s(60,"Plakat"),n(),o(61,"input",14,1),u("change",function(_){return f(c),h(i.onFileSelected(_,"poster"))}),n(),o(63,"input",18),u("click",function(){f(c);let _=w(62);return h(_.click())}),n(),p(64,wi,3,0,"button",16)(65,Ci,3,0,"button",16),n()(),p(66,Si,2,1,"div",17),o(67,"div",4)(68,"mat-form-field",5)(69,"mat-label"),s(70,"Identyfikator na stronie bilety24.pl"),n(),y(71,"input",19),p(72,Ii,2,0,"mat-error",7),n()()(),o(73,"div",4)(74,"div",20)(75,"button",21),u("click",function(){return f(c),h(i.savePerformance())}),s(76," Zapisz "),n()(),o(77,"div")(78,"button",22),u("click",function(){return f(c),h(i.router.navigate([".."],{relativeTo:i.route}))}),s(79," Anuluj "),n()()()}if(r&2){let c,d,_,Y,Q,X,Z,J,ee,te,k,ie;l("ngIf",i.isLoading),a(),l("formGroup",i.newPerformanceForm),a(6),l("ngIf",(c=i.newPerformanceForm.get("title"))==null?null:c.hasError("required")),a(),l("ngIf",(d=i.newPerformanceForm.get("title"))==null?null:d.hasError("minlength")),a(),l("ngIf",(_=i.newPerformanceForm.get("title"))==null?null:_.hasError("maxlength")),a(),l("ngIf",(Y=i.newPerformanceForm.get("title"))==null?null:Y.hasError("placeExists")),a(6),l("ngForOf",i.genres),a(),l("ngIf",(Q=i.newPerformanceForm.get("genre"))==null?null:Q.hasError("required")),a(6),l("ngForOf",i.places),a(),l("ngIf",(X=i.newPerformanceForm.get("place"))==null?null:X.hasError("required")),a(6),l("ngForOf",i.durations),a(),l("ngIf",(Z=i.newPerformanceForm.get("duration"))==null?null:Z.hasError("required")),a(6),l("ngForOf",i.breaksCount),a(),l("ngIf",(J=i.newPerformanceForm.get("breaksCount"))==null?null:J.hasError("required")),a(6),l("ngIf",(ee=i.newPerformanceForm.get("description"))==null?null:ee.hasError("required")),a(),l("ngIf",(te=i.newPerformanceForm.get("description"))==null?null:te.hasError("maxlength")),a(7),l("value",i.selectedFileNames.mainImage||"Nie wybrano pliku"),a(),l("ngIf",!i.selectedFileNames.mainImage),a(),l("ngIf",i.selectedFileNames.mainImage),a(),l("ngIf",(k=i.newPerformanceForm.get("mainImage"))==null?null:k.hasError("required")),a(),l("ngIf",i.isFileLoaded.mainImage),a(7),l("value",i.selectedFileNames.poster||"Nie wybrano pliku"),a(),l("ngIf",!i.selectedFileNames.poster),a(),l("ngIf",i.selectedFileNames.poster),a(),l("ngIf",i.isFileLoaded.poster),a(6),l("ngIf",(ie=i.newPerformanceForm.get("externalId"))==null?null:ie.hasError("required")),a(3),l("disabled",i.newPerformanceForm.invalid)}},dependencies:[me,L,F,fe,q,Ce,ue,O,Pe,_e,ge,ve,ye,be,B,E,z,$,he],styles:["mat-sidenav-content[_ngcontent-%COMP%]{max-width:80%;overflow-x:hidden}"]})}}return e})();function Ai(e,m){e&1&&y(0,"mat-progress-bar",23)}function Ei(e,m){e&1&&(o(0,"mat-error"),s(1," Nazwa miejsca jest wymagana "),n())}function Fi(e,m){e&1&&(o(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 wi\u0119cej ni\u017C 2 "),n())}function Oi(e,m){e&1&&(o(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 256 "),n())}function ki(e,m){e&1&&(o(0,"mat-error"),s(1," Nazwa spektaklu ju\u017C istnieje "),n())}function xi(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t.id),a(),C(" ",t.name," ")}}function Ti(e,m){e&1&&(o(0,"mat-error"),s(1," Gatunek jest wymagany "),n())}function Mi(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t.id),a(),C(" ",t.name," ")}}function Ni(e,m){e&1&&(o(0,"mat-error"),s(1," Miejsce jest wymagane "),n())}function Di(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t),a(),C(" ",t," ")}}function Ri(e,m){e&1&&(o(0,"mat-error"),s(1," Czas trwania jest wymagany "),n())}function Vi(e,m){if(e&1&&(o(0,"mat-option",24),s(1),n()),e&2){let t=m.$implicit;l("value",t),a(),C(" ",t," ")}}function ji(e,m){e&1&&(o(0,"mat-error"),s(1," Ilo\u015B\u0107 przerw jest wymagana "),n())}function Li(e,m){e&1&&(o(0,"mat-error"),s(1," Opis jest wymagany "),n())}function zi(e,m){e&1&&(o(0,"mat-error"),s(1," D\u0142ugo\u015B\u0107 musi by\u0107 mniej ni\u017C 5001 znak "),n())}function qi(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t),P();let i=w(51);return h(i.click())}),o(1,"mat-icon",26),s(2,"image"),n()()}}function Bi(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t);let i=P();return h(i.onDeleteImage("mainImage"))}),o(1,"mat-icon",26),s(2,"delete"),n()()}}function Gi(e,m){e&1&&(o(0,"mat-error"),s(1," G\u0142\xF3wny obraz jest wymagany "),n())}function Hi(e,m){if(e&1&&(o(0,"div",4),y(1,"img",27),n()),e&2){let t=P();a(),l("src",t.mainImage,V)}}function $i(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t),P();let i=w(62);return h(i.click())}),o(1,"mat-icon",26),s(2,"image"),n()()}}function Wi(e,m){if(e&1){let t=b();o(0,"button",25),u("click",function(){f(t);let i=P();return h(i.onDeleteImage("poster"))}),o(1,"mat-icon",26),s(2,"delete"),n()()}}function Ui(e,m){if(e&1&&(o(0,"div",4),y(1,"img",28),n()),e&2){let t=P();a(),l("src",t.poster,V)}}function Ki(e,m){e&1&&(o(0,"mat-error"),s(1," Identyfikator jest wymagany "),n())}var xt=(()=>{class e{constructor(t,r,i,c,d,_){this.performanceService=t,this.placeService=r,this.genreService=i,this.fb=c,this.router=d,this.route=_,this.existingPerformances=[],this.mainImage="data:image/jpeg;base64,",this.poster="data:image/jpeg;base64,",this.subscription=new I,this.places=[],this.genres=[],this.durations=["0:30","1:00","1:30","1:40","2:00","2:30","3:00"],this.breaksCount=[0,1,2,3],this.selectedFiles={mainImage:void 0,poster:void 0},this.selectedFileNames={mainImage:void 0,poster:void 0},this.isFileLoaded={mainImage:!1,poster:!1},this.isLoading=!0}ngOnInit(){this.editPerformanceForm=this.fb.group({id:[""],title:["",[v.required,v.minLength(3),v.maxLength(255)]],genre:["",[v.required]],place:["",[v.required]],duration:["",[v.required]],breaksCount:["",[v.required]],description:["",[v.required,v.maxLength(5e3)]],mainImage:[null,[v.required]],poster:[null],externalId:["",[v.required]]},{updateOn:"blur"});let t=+this.route.snapshot.paramMap.get("id");t&&Re({places:this.placeService.getPlaces(),genres:this.genreService.getGenres(),performance:this.performanceService.getPerformanceById(t)}).subscribe(({places:r,genres:i,performance:c})=>{this.places=r,this.genres=i,c&&(this.editPerformanceForm.patchValue({id:c.id,title:c.title,genre:c.genre,place:c.place,duration:this.durations.includes(c.duration.substring(1,5))?c.duration?.substring(1,5):"",breaksCount:this.breaksCount.includes(Number(c.breaksCount))?Number(c.breaksCount):"",description:c.description,externalId:c.externalId}),Object.keys(this.editPerformanceForm.controls).forEach(d=>{this.editPerformanceForm.get(d)?.updateValueAndValidity()}),this.mainImage+=c.mainImage,this.updateFileState("mainImage",c.mainImage,"Przes\u0142any g\u0142\xF3wny obraz"),this.poster+=c.poster,this.updateFileState("poster",c.poster,"Przes\u0142any plakat"),this.selectedFiles.mainImage=c.mainImage,this.selectedFiles.poster=c.poster,this.selectedFileNames.mainImage=c.mainImage?"Przes\u0142any g\u0142\xF3wny obraz":void 0,this.selectedFileNames.poster=c.poster?"Przes\u0142any plakat":void 0,this.isFileLoaded.mainImage=!!c.mainImage,this.isFileLoaded.poster=!!c.poster,this.isLoading=!1)})}ngOnDestroy(){this.subscription.unsubscribe()}updateFileState(t,r,i){r&&(this.selectedFiles[t]=r,this.selectedFileNames[t]=i,this.isFileLoaded[t]=!0,this.editPerformanceForm.patchValue({[t]:i}),this.editPerformanceForm.get(t)?.updateValueAndValidity())}onFileSelected(t,r){let i=t.target;if(i.files&&i.files.length>0){let c=i.files[0];this.selectedFileNames[r]=c.name,this.isFileLoaded[r]=!1;let d=new FileReader;d.readAsDataURL(c),d.onload=()=>{this.selectedFiles[r]=d.result.split(",")[1],this.isFileLoaded[r]=!0,this[r]=d.result,this.editPerformanceForm.patchValue({[r]:c.name}),this.editPerformanceForm.get(r)?.updateValueAndValidity()},i.value=""}}savePerformance(){if(this.editPerformanceForm.invalid){console.error("Formularz jest nieprawid\u0142owy lub plik nadal si\u0119 \u0142aduje!");return}let t={id:this.editPerformanceForm.value.id,title:this.editPerformanceForm.value.title,genre:this.editPerformanceForm.value.genre,place:this.editPerformanceForm.value.place,duration:this.editPerformanceForm.value.duration,breaksCount:this.editPerformanceForm.value.breaksCount,description:this.editPerformanceForm.value.description,mainImage:this.selectedFiles.mainImage,poster:this.selectedFiles.poster,externalId:+this.editPerformanceForm.value.externalId};this.performanceService.updatePerformance(t).subscribe(()=>{this.router.navigate(["../.."],{relativeTo:this.route})})}onDeleteImage(t){this.selectedFiles[t]=void 0,this.selectedFileNames[t]=void 0,this.isFileLoaded[t]=!1,this.editPerformanceForm.patchValue({[t]:null}),this.editPerformanceForm.get(t)?.updateValueAndValidity(),this[t]=""}static{this.\u0275fac=function(r){return new(r||e)(g(K),g(W),g(Ee),g(we),g(pe),g(ce))}}static{this.\u0275cmp=A({type:e,selectors:[["app-admin-panel-performance-edit"]],decls:80,vars:29,consts:[["mainImageInput",""],["posterInput",""],["class","mb-1","mode","indeterminate",4,"ngIf"],[3,"formGroup"],[1,"ms-1","mb-1","d-flex","align-items-center"],["appearance","fill",2,"width","500px"],["matInput","","formControlName","title","placeholder","Wprowad\u017A nazw\u0119 miejsca"],[4,"ngIf"],["formControlName","genre",3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","place",3,"value"],["formControlName","duration"],["formControlName","breaksCount"],["matInput","","formControlName","description","placeholder","Wprowad\u017A opis"],["type","file","accept","image/*","hidden","",3,"change"],["matInput","","readonly","","required","",3,"click","value"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["class","ms-1 mb-1 d-flex align-items-center",4,"ngIf"],["matInput","","readonly","",3,"click","value"],["matInput","","formControlName","externalId","placeholder","Wprowad\u017A identyfikator"],[1,"me-4"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"],["mat-flat-button","","color","warn","type","button",3,"click"],["mode","indeterminate",1,"mb-1"],[3,"value"],["mat-icon-button","","matSuffix","",3,"click"],["matSuffix",""],["width","25%","height","25%","alt","G\u0142\xF3wny obraz",3,"src"],["width","25%","height","25%","alt","plakat",3,"src"]],template:function(r,i){if(r&1){let c=b();p(0,Ai,1,0,"mat-progress-bar",2),o(1,"form",3)(2,"div",4)(3,"mat-form-field",5)(4,"mat-label"),s(5,"Nazwa spektaklu"),n(),y(6,"input",6),p(7,Ei,2,0,"mat-error",7)(8,Fi,2,0,"mat-error",7)(9,Oi,2,0,"mat-error",7)(10,ki,2,0,"mat-error",7),n()(),o(11,"div",4)(12,"mat-form-field",5)(13,"mat-label"),s(14,"Gatunek"),n(),o(15,"mat-select",8),p(16,xi,2,2,"mat-option",9),n(),p(17,Ti,2,0,"mat-error",7),n()(),o(18,"div",4)(19,"mat-form-field",5)(20,"mat-label"),s(21,"Miejsce"),n(),o(22,"mat-select",10),p(23,Mi,2,2,"mat-option",9),n(),p(24,Ni,2,0,"mat-error",7),n()(),o(25,"div",4)(26,"mat-form-field",5)(27,"mat-label"),s(28,"Czas trwania"),n(),o(29,"mat-select",11),p(30,Di,2,2,"mat-option",9),n(),p(31,Ri,2,0,"mat-error",7),n()(),o(32,"div",4)(33,"mat-form-field",5)(34,"mat-label"),s(35,"Ilo\u015B\u0107 przerw"),n(),o(36,"mat-select",12),p(37,Vi,2,2,"mat-option",9),n(),p(38,ji,2,0,"mat-error",7),n()(),o(39,"div",4)(40,"mat-form-field",5)(41,"mat-label"),s(42,"Opis"),n(),y(43,"textarea",13),p(44,Li,2,0,"mat-error",7)(45,zi,2,0,"mat-error",7),n()(),o(46,"div",4)(47,"mat-form-field",5)(48,"mat-label"),s(49,"G\u0142\xF3wny obraz"),n(),o(50,"input",14,0),u("change",function(_){return f(c),h(i.onFileSelected(_,"mainImage"))}),n(),o(52,"input",15),u("click",function(){f(c);let _=w(51);return h(_.click())}),n(),p(53,qi,3,0,"button",16)(54,Bi,3,0,"button",16)(55,Gi,2,0,"mat-error",7),n()(),p(56,Hi,2,1,"div",17),o(57,"div",4)(58,"mat-form-field",5)(59,"mat-label"),s(60,"Plakat"),n(),o(61,"input",14,1),u("change",function(_){return f(c),h(i.onFileSelected(_,"poster"))}),n(),o(63,"input",18),u("click",function(){f(c);let _=w(62);return h(_.click())}),n(),p(64,$i,3,0,"button",16)(65,Wi,3,0,"button",16),n()(),p(66,Ui,2,1,"div",17),o(67,"div",4)(68,"mat-form-field",5)(69,"mat-label"),s(70,"Identyfikator na stronie bilety24.pl"),n(),y(71,"input",19),p(72,Ki,2,0,"mat-error",7),n()()(),o(73,"div",4)(74,"div",20)(75,"button",21),u("click",function(){return f(c),h(i.savePerformance())}),s(76," Zapisz "),n()(),o(77,"div")(78,"button",22),u("click",function(){return f(c),h(i.router.navigate(["../.."],{relativeTo:i.route}))}),s(79," Anuluj "),n()()()}if(r&2){let c,d,_,Y,Q,X,Z,J,ee,te,k,ie,se,De;l("ngIf",i.isLoading),a(),l("formGroup",i.editPerformanceForm),a(6),l("ngIf",(c=i.editPerformanceForm.get("title"))==null?null:c.hasError("required")),a(),l("ngIf",(d=i.editPerformanceForm.get("title"))==null?null:d.hasError("minlength")),a(),l("ngIf",(_=i.editPerformanceForm.get("title"))==null?null:_.hasError("maxlength")),a(),l("ngIf",(Y=i.editPerformanceForm.get("title"))==null?null:Y.hasError("placeExists")),a(5),l("value",(Q=i.editPerformanceForm.get("genre"))==null?null:Q.value),a(),l("ngForOf",i.genres),a(),l("ngIf",(X=i.editPerformanceForm.get("genre"))==null?null:X.hasError("required")),a(5),l("value",(Z=i.editPerformanceForm.get("place"))==null?null:Z.value),a(),l("ngForOf",i.places),a(),l("ngIf",(J=i.editPerformanceForm.get("place"))==null?null:J.hasError("required")),a(6),l("ngForOf",i.durations),a(),l("ngIf",(ee=i.editPerformanceForm.get("duration"))==null?null:ee.hasError("required")),a(6),l("ngForOf",i.breaksCount),a(),l("ngIf",(te=i.editPerformanceForm.get("breaksCount"))==null?null:te.hasError("required")),a(6),l("ngIf",((k=i.editPerformanceForm.get("description"))==null?null:k.hasError("required"))&&((k=i.editPerformanceForm.get("description"))==null?null:k.dirty)),a(),l("ngIf",(ie=i.editPerformanceForm.get("description"))==null?null:ie.hasError("maxlength")),a(7),l("value",i.selectedFileNames.mainImage||"Nie wybrano pliku"),a(),l("ngIf",!i.selectedFiles.mainImage),a(),l("ngIf",i.selectedFiles.mainImage),a(),l("ngIf",((se=i.editPerformanceForm.get("mainImage"))==null?null:se.hasError("required"))&&((se=i.editPerformanceForm.get("mainImage"))==null?null:se.dirty)),a(),l("ngIf",i.isFileLoaded.mainImage),a(7),l("value",i.selectedFileNames.poster||"Nie wybrano pliku"),a(),l("ngIf",!i.selectedFiles.poster),a(),l("ngIf",i.selectedFiles.poster),a(),l("ngIf",i.isFileLoaded.poster),a(6),l("ngIf",(De=i.editPerformanceForm.get("externalId"))==null?null:De.hasError("required")),a(3),l("disabled",i.editPerformanceForm.invalid)}},dependencies:[me,L,F,fe,q,Ce,ue,O,Pe,_e,ge,ve,ye,be,B,E,z,$,he]})}}return e})();var Yi=[{path:"",component:Ot},{path:"new",component:kt},{path:":id/edit",component:xt}],Tt=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=re({type:e})}static{this.\u0275inj=oe({imports:[xe.forChild(Yi),xe]})}}return e})();var Qi=["panel"],Xi=["*"];function Zi(e,m){if(e&1){let t=b();o(0,"div",1,0),u("@panelAnimation.done",function(i){f(t);let c=P();return h(c._animationDone.next(i))}),Ke(2),n()}if(e&2){let t=m.id,r=P();We(r._classList),$e("mat-mdc-autocomplete-visible",r.showPanel)("mat-mdc-autocomplete-hidden",!r.showPanel)("mat-primary",r._color==="primary")("mat-accent",r._color==="accent")("mat-warn",r._color==="warn"),l("id",r.id)("@panelAnimation",r.isOpen?"visible":"hidden"),He("aria-label",r.ariaLabel||null)("aria-labelledby",r._getPanelAriaLabelledby(t))}}var Ji=mt("panelAnimation",[pt("void, hidden",le({opacity:0,transform:"scaleY(0.8)"})),Te(":enter, hidden => visible",[ct([de("0.03s linear",le({opacity:1})),de("0.12s cubic-bezier(0, 0, 0.2, 1)",le({transform:"scaleY(1)"}))])]),Te(":leave, visible => hidden",[de("0.075s linear",le({opacity:0}))])]),en=0,Ne=class{constructor(m,t){this.source=m,this.option=t}},tn=new Le("mat-autocomplete-default-options",{providedIn:"root",factory:nn});function nn(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}var Mt=(()=>{class e{get isOpen(){return this._isOpen&&this.showPanel}_setColor(t){this._color=t,this._changeDetectorRef.markForCheck()}set classList(t){this._classList=t,this._elementRef.nativeElement.className=""}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=t,this._syncParentProperties()}_syncParentProperties(){if(this.options)for(let t of this.options)t._changeDetectorRef.markForCheck()}constructor(t,r,i,c){this._changeDetectorRef=t,this._elementRef=r,this._defaults=i,this._activeOptionChanges=I.EMPTY,this._animationDone=new R,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new R,this.opened=new R,this.closed=new R,this.optionActivated=new R,this.id=`mat-autocomplete-${en++}`,this.inertGroups=c?.SAFARI||!1,this.autoActiveFirstOption=!!i.autoActiveFirstOption,this.autoSelectActiveOption=!!i.autoSelectActiveOption,this.requireSelection=!!i.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new at(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(t=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[t]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe(),this._animationDone.complete()}_setScrollTop(t){this.panel&&(this.panel.nativeElement.scrollTop=t)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(t){let r=new Ne(this,t);this.optionSelected.emit(r)}_getPanelAriaLabelledby(t){if(this.ariaLabel)return null;let r=t?t+" ":"";return this.ariaLabelledby?r+this.ariaLabelledby:t}_skipPredicate(){return!1}static{this.\u0275fac=function(r){return new(r||e)(g(et),g(qe),g(tn),g(rt))}}static{this.\u0275cmp=A({type:e,selectors:[["mat-autocomplete"]],contentQueries:function(r,i,c){if(r&1&&(ke(c,E,5),ke(c,st,5)),r&2){let d;M(d=N())&&(i.options=d),M(d=N())&&(i.optionGroups=d)}},viewQuery:function(r,i){if(r&1&&(ae(Be,7),ae(Qi,5)),r&2){let c;M(c=N())&&(i.template=c.first),M(c=N())&&(i.panel=c.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[S.None,"aria-label","ariaLabel"],ariaLabelledby:[S.None,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[S.HasDecoratorInputTransform,"autoActiveFirstOption","autoActiveFirstOption",j],autoSelectActiveOption:[S.HasDecoratorInputTransform,"autoSelectActiveOption","autoSelectActiveOption",j],requireSelection:[S.HasDecoratorInputTransform,"requireSelection","requireSelection",j],panelWidth:"panelWidth",disableRipple:[S.HasDecoratorInputTransform,"disableRipple","disableRipple",j],classList:[S.None,"class","classList"],hideSingleSelectionIndicator:[S.HasDecoratorInputTransform,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",j]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],standalone:!0,features:[Qe([{provide:lt,useExisting:e}]),Ge,Xe],ngContentSelectors:Xi,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(r,i){r&1&&(Ue(),p(0,Zi,3,16,"ng-template"))},styles:["div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:static;border-radius:var(--mat-autocomplete-container-shape);box-shadow:var(--mat-autocomplete-container-elevation-shadow);background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[Ji]},changeDetection:0})}}return e})();var Vo=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=re({type:e})}static{this.\u0275inj=oe({imports:[it,Tt,F,Ie,G,Ae,Se,q,O,dt,B,E,Mt,z,$]})}}return e})();export{Vo as AdminPanelPerformanceModule};
